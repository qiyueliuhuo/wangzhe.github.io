<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>碎碎念</title>
      <link href="/2020/07/20/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"/>
      <url>/2020/07/20/%E7%A2%8E%E7%A2%8E%E5%BF%B5/</url>
      
        <content type="html"><![CDATA[<p>黄金时代的我。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>机器学习之支持向量机</title>
      <link href="/2020/07/14/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/"/>
      <url>/2020/07/14/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>卷积神经网络入门</title>
      <link href="/2020/06/29/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%85%A5%E9%97%A8/"/>
      <url>/2020/06/29/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h3><h3 id="什么是卷积"><a class="markdownIt-Anchor" href="#什么是卷积"></a> 什么是卷积</h3><p>什么是卷积？最开始听到这个词估计大多数人都比较蒙，乘积、点积、菜鸡都听说过，但是卷积到底是什么呢？</p><p>笔者最开始接触到卷积这个词是在大学的一门课，《线性系统与信号》。下面先看卷积的数学定义：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>τ</mi><mo stretchy="false">)</mo><mi>d</mi><mi>τ</mi></mrow><annotation encoding="application/x-tex">\int_{-\infty}^{\infty} f(\tau) g(x-\tau) d \tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.384573em;vertical-align:-0.970281em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.414292em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span></span></span></span></span></p><p>一种解释是相关，一种解释是卷积</p><p>思考：<br />信号分类的一个角度：时域、空域、频域<br />卷积：现实生活中，给定一个刺激，影响往往持续一段时间</p><p>卷积神经网络 不应该是卷积，应该是相关</p><p>先用小的滤波器，再用大的滤波器，由小到大</p><p>时间域上卷积：系统（或者是滤波器）输入一个脉冲信号（刺激）后，系统将输出一个具有长时间输出的相应，而非短时（瞬时）输出。<br />空间域上卷积： 系统（数字滤波器或者核）输入一个脉冲信号（刺激）后，系统会在在某个空间域内做出相应，而非某一空间点上相应。</p><p><a href="https://www.zhihu.com/search?type=content&amp;q=%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" target="_blank" rel="noopener">https://www.zhihu.com/search?type=content&amp;q=卷积神经网络</a><br /><img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200706204534.png" alt="卷积思考" /><br />小卷积核识别出小视野的模型或者叫形状，把卷积后的图片叠加，形成更大的宏观图，然后在更大的图片上识别更宏观的形式，猜测：一个物体的真实标签即和微观的feature相关也和经过多次卷积运算后的feature也相关。</p><p>深层网络并行加速      || —&gt; || —&gt; || --&gt; || --&gt; ||<br />可以传播快点    第一波到第二层，就开始第二波    像水浪一样一波一波</p><p>神经网络参数类比为基因，通过遗传算法更新参数初始值，训练后，表现差的参数淘汰掉。</p><p><a href="https://www.zhihu.com/search?type=content&amp;q=%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" target="_blank" rel="noopener">https://www.zhihu.com/search?type=content&amp;q=卷积神经网络</a><br />多个卷积核卷积完后，将结果相加，在经过更高的卷积核来卷积</p><p>参考：<a href="https://juejin.im/post/5ceeef01518825351e354747" target="_blank" rel="noopener">https://juejin.im/post/5ceeef01518825351e354747</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>神经网络之反向传播算法</title>
      <link href="/2020/06/13/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B9%8B%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/"/>
      <url>/2020/06/13/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B9%8B%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h3><p>人工神经网络（Artificial Neural Network，ANN）是一门重要的机器学习技术。它是目前最为火热的研究方向–深度学习（Deep Learning）的基础。学习神经网络不仅可以让你掌握一门强大的机器学习方法，同时也可以更好地帮助你理解深度学习技术。</p><p>四年前，韩国围棋九段棋手李世石与谷歌人工智能 AlphaGo 之间的围棋比赛，最终 AlphaGo 以四比一取胜，这让人工智能 AlphaGo 背后的技术——深度学习算法大火，笔者也是从这个时候开始关注深度学习，对计算机领域产生了兴趣。此后一年，谷歌又推出 AlphaGo 围棋升级版，并邀请世界围棋冠军、中国棋手柯洁于 2017 年 5 月份与之进行围棋大战，笔者全程直播观看了 AlphaGo 与柯洁人机围棋大战，在看到作为人类智慧的顶峰柯洁含泪认输后，笔者被 AlphaGo 背后的技术神经网络所深深震撼（还包括另一种技术：蒙特卡洛树搜索）。围棋不同于其他棋，计算机目前无法遍历围棋的所有可能的下法，所以算法必须尝试模拟人类大脑的下棋，根据以往学习到的经验判断落棋点，而不是暴力遍历所有可能性后选择最佳的下棋点，从而取胜。</p><p>这篇文章试图介绍深度学习中很重要的技术——神经网络，并重点介绍神经网络中运用到反向传播算法。</p><blockquote><p>在笔者大学期间，除了两场围棋人机大战外，还有一场比较有意思的大型实验：大贝尔实验——关于验证基础物理量子力学中非常有名且重要的贝尔不等式的实验。所谓“遇事不决，量子力学”，这个梗就表示了量子力学中存在一些无法解释（宏观世界难以理解）的现象，若有兴趣可以再了解下。</p></blockquote><h3 id="感知机"><a class="markdownIt-Anchor" href="#感知机"></a> 感知机</h3><h4 id="感知机介绍"><a class="markdownIt-Anchor" href="#感知机介绍"></a> 感知机介绍</h4><p>首先让我们先来了解下神经网络中最简单也是最基础的一种结构——感知机（Perceptron），如下图：<br /><img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/Ncell.png" alt="感知机" /></p><p>研究者模拟生物神经网络中的一个简单的<strong>神经元</strong>的行为——神经元兴奋过程，与之对应的感知机基础概念被提出，这里我们可以把<strong>权重</strong>当作突触、把<strong>偏置</strong>当作阈值以及把<strong>激活函数</strong>当作细胞体，当经过突触的信号总和超过了某个阈值（偏置项），细胞体就会兴奋（激活函数），产生电脉冲（输出 1），而当信号量总和未超过阈值，不产生电脉冲（输出 0）。它可以被视为一种最简单形式的前馈神经网络，是一种二元线性分类器。感知机（单个神经元）代表了从输入空间到输出空间的如下函数：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = f(\sum_{i=1}^{n}w_ix_i + b) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></p><p>理想中的激活函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mo separator="true">⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(·)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">)</span></span></span></span>是下图 a 所示的阶跃函数，输出“1”对应神经元兴奋，输出“0”对应神经元抑制，然而阶跃函数具有不连续、不光滑等不太好的数学性质，因此实际常用 Sigmoid 函数作为激活函数，如下图 b 所示，该函数将实域范围的输出挤压到（0，1）范围输出，也被称为“挤压函数”。<br /><img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200614130934.png" alt="阶跃函数和Sigmoid函数" /><br />对于<strong>感知机模型</strong>的<strong>理解</strong>：感知机模型的假设空间（容量）是定义在特征空间中的所有线性分类模型或线性分类器。感知机对应函数值为 0，即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo separator="true">⋅</mo><mi>x</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w·x + b = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，对应于特征空间<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">R^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>中的一个超平面<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>是超平面的法向量，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>是超平面的截距，这个超平面将特征空间划分为两个部分，位于两部分空间中的点分别被分为正、负两类。</p><h4 id="感知机学习策略"><a class="markdownIt-Anchor" href="#感知机学习策略"></a> 感知机学习策略</h4><p>感知机学习以<strong>最小化</strong>误分类点到超平面<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span>的总距离为<strong>目标</strong>，因此感知机学习算法是<strong>误分类驱动</strong>的，具体使用时采用<strong>随机梯度下降法</strong>。<br />误分类点到超平面的总距离为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>w</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi>M</mi></mrow></munder><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">⋅</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">-\frac{1}{||w||}\sum_{x_i\in M}y_i(w·x_i + b) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.7158759999999997em;vertical-align:-1.394436em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">∣</span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.394436em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_i, y_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>为样本点，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>为误分类点的集合，对于误分类点来说<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">⋅</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">-y_i(w·x_i + b) &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>成立，且当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">⋅</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(w·x_i + b) &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>时，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y_i = -1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span>，当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">⋅</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(w·x_i + b) &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>时，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y_i = +1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span>。<br />不考虑<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>w</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{||w||}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.365108em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mord mtight">∣</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，就得到感知机学习的损失函数为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi>M</mi></mrow></munder><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">⋅</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L(w, b) = -\sum_{x_i\in M}y_i(w·x_i + b) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4444410000000003em;vertical-align:-1.394436em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.394436em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></p><p>损失函数的梯度为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">∇</mi><mi>w</mi></msub><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi>M</mi></mrow></munder><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\nabla_w L(w, b) = - \sum_{x_i\in M}y_ix_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4444410000000003em;vertical-align:-1.394436em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.394436em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">∇</mi><mi>b</mi></msub><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi>M</mi></mrow></munder><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\nabla_b L(w, b) = - \sum_{x_i\in M}y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4444410000000003em;vertical-align:-1.394436em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.394436em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>采用随机梯度下降法，随机选取一个误分类点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_i, y_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">w, b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span></span></span></span>进性更新：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>←</mo><mi>w</mi><mo>+</mo><mi>η</mi><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w \leftarrow w + \eta y_ix_i </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>←</mo><mi>b</mi><mo>+</mo><mi>η</mi><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b \leftarrow b + \eta y_i </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>具体推导过程及算法迭代过程参见李航《统计学习方法》，代码实现参见<a href="https://github.com/fengdu78/lihang-code/blob/master/%E7%AC%AC02%E7%AB%A0%20%E6%84%9F%E7%9F%A5%E6%9C%BA/2.Perceptron.ipynb" target="_blank" rel="noopener">此 github</a>。</p><h4 id="感知机模型存在的问题"><a class="markdownIt-Anchor" href="#感知机模型存在的问题"></a> 感知机模型存在的问题</h4><p>感知机的学习能力非常有限，与、或、非问题都是线性可分的，所以感知机可以处理，但是感知机却不能解决异或简单的非线性可分问题。<br />异或问题暴露出这样一个问题，即在现实任务中，原始样本空间内也许并不存在一个能正确划分两类样本的超平面，对于这样的问题，一种方法，<strong>1)</strong> 可将样本从原始空间<strong>映射</strong>到一个<strong>更高维</strong>的特征空间（或者不用更高维也可以），所谓的核函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">ϕ</span></span></span></span>，使得样本在这个特征空间内线性可分，幸运的是，如果原始空间是有限维，那么一定存在一个高维特征空间使得样本线性可分。<strong>2)</strong> 另一种方法，通过增加感知机的层数，使得形成一个神经网络，其中输入层神经元接受外界输入，隐层与输出层神经元对信号进行加工，最终结果由输出层神经元输出。（花书理解：深层神经网络中的隐藏层即代表输入经过了一个核函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">ϕ</span></span></span></span>变换，那么以上两种方式都是在寻找一个<strong>恰当的核函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">ϕ</span></span></span></span></strong>，神经网络的方式是通过网络自主学习学到恰当的核函数）</p><h3 id="神经网络"><a class="markdownIt-Anchor" href="#神经网络"></a> 神经网络</h3><h4 id="神经网络介绍"><a class="markdownIt-Anchor" href="#神经网络介绍"></a> 神经网络介绍</h4><p>考虑到感知机模型存在的问题，即只能解决线性可分问题，我们将感知机进行连接，形成多层感知机——神经网络，如下图<br /><img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200625230159.png" alt="单隐层神经网络" /><br />用矩阵形式表示神经网络运算过程，如下：<br />第一层加权和为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>X</mi><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">A^{(1)} = XW^{(1)} + B^{(1)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0213299999999998em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">N\times2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>大小矩阵，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>代表输入神经网络的数据有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>个样本，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>代表每个样本有两个特征值；<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">2\times3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>大小的矩阵代表输入层到中间层的线性变换权重矩阵；<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>为偏置项。<br />第一层激活后为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Z</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z^{(1)} = sigmoid(A^{(1)}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中 sigmoid 函数作用于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">A^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>中的每一个元素。将第一层的输出<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Z</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">Z^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>作为第二层的输入，同理得：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>Z</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">A^{(2)} = Z^{(1)}W^{(2)} + B^{(2)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0213299999999998em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><strong>注意：</strong> 因为单隐层神经网络只经过两层传播，那么第二层的输出就是网络的输出，这里一般（1）回归问题使用恒等函数作为激活函数，（2）分类问题可以使用 softmax 函数。我们把此神经网络看作是分类采用 softmax 函数：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">y_k = \frac{exp(a_k)}{\sum_{i=1}^{n}exp(a_i)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.421002em;vertical-align:-0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>那么神经网络的输出为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y = softmax(A^{(2)}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">N\times2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>矩阵，形如：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.2650877</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.7349123</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.8987211</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1012788</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left[    \begin{array}{ccc}        0.2650877&amp; 0.7349123\\\\        \vdots &amp; \vdots\\\\        0.8987211 &amp; 0.1012788\\\\    \end{array}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.86em;vertical-align:-3.6800000000000006em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.156985000000001em;"><span style="top:-0.14996500000000068em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-1.3049650000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-1.9059650000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.5069650000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.1079650000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.7089650000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.309965em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.910965000000001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-6.156985em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6500549999999996em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.18em;"><span style="top:-7.027500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">6</span><span class="mord">5</span><span class="mord">0</span><span class="mord">8</span><span class="mord">7</span><span class="mord">7</span></span></span><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-3.9674999999999994em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span><span style="top:-1.5674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mord">9</span><span class="mord">8</span><span class="mord">7</span><span class="mord">2</span><span class="mord">1</span><span class="mord">1</span></span></span><span style="top:-0.36749999999999944em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6800000000000006em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.18em;"><span style="top:-7.027500000000001em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">3</span><span class="mord">4</span><span class="mord">9</span><span class="mord">1</span><span class="mord">2</span><span class="mord">3</span></span></span><span style="top:-3.9675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mord">2</span><span class="mord">7</span><span class="mord">8</span><span class="mord">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.156985000000001em;"><span style="top:-0.14996500000000068em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-1.3049650000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-1.9059650000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.5069650000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.1079650000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.7089650000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.309965em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.910965000000001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-6.156985em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6500549999999996em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>代表第一个样本预测为第二个分类概率为 0.7349123，大于 0.5，可以认为预测为第二个分类；最后一个样本预测为第一个分类概率为 0.8987211，可以认为预测为第一个分类。（当然只有两个样本的情况下一般看作正类和负类，只需要一个输出神经元，使用 sigmoid 函数激活即可。）该模型使用 softmax 函数作为激活函数，可以推广到多分类情况下。</p><h4 id="神经网络学习策略"><a class="markdownIt-Anchor" href="#神经网络学习策略"></a> 神经网络学习策略</h4><p>神经网络的学习中使用的指标为<strong>损失函数（loss function）</strong>，即以最小化损失函数为目标，理论上，损失函数可以使用任意函数，但实际中一般用<strong>均方误差</strong>和<strong>交叉熵误差</strong>等。<br />均方误差为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mi>k</mi></munder><mo stretchy="false">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><msub><mi>t</mi><mi>k</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E = \frac{1}{2}\sum_{k}(y_k - t_k)^2 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.623553em;vertical-align:-1.3021129999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000005em;"><span style="top:-1.847887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021129999999999em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p>交叉熵误差为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>k</mi></munder><msub><mi>t</mi><mi>k</mi></msub><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>e</mi></msub><msub><mi>y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">E = -\sum_{k}t_k\log_ey_k </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3521180000000004em;vertical-align:-1.3021129999999999em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000005em;"><span style="top:-1.847887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021129999999999em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">y_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示神经网络的输出，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">t_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示监督数据，k 表示数据的维度，如在手写数字识别例子中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">y_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">t_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>如下 10 个元素构成的数据：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = [<span class="number">0.1</span>, <span class="number">0.05</span>, <span class="number">0.6</span>, <span class="number">0.0</span>, <span class="number">0.05</span>, <span class="number">0.1</span>, <span class="number">0.0</span>, <span class="number">0.1</span>, <span class="number">0.0</span>, <span class="number">0.0</span>]</span><br><span class="line">t = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>在批量样本学习中，可以将对所有的样本的单个误差求和，然后再除以样本数 N，求得单个数据的“平均损失函数”，将它作为<strong>损失函数</strong>。<br />神经网络学习的策略和感知机学习策略都是一个最优化问题，神经网络学习中也是采用<strong>随机梯度下降法</strong>，与感知机学习策略更新参数类似，对于神经网络任意参数（线性权重、线性偏置等需要学习参数）更新估计式如下</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mo>←</mo><mi>v</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">v \leftarrow v + \Delta v </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></span></p><p>更新参数为<strong>线性连接权重参数</strong>时</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>h</mi><mi>j</mi></mrow></msub><mo>←</mo><msub><mi>w</mi><mrow><mi>h</mi><mi>j</mi></mrow></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><msub><mi>w</mi><mrow><mi>h</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{hj} \leftarrow w_{hj} + \Delta w_{hj} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>采用梯度下降法，有</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>h</mi><mi>j</mi></mrow></msub><mo>←</mo><msub><mi>w</mi><mrow><mi>h</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>η</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>h</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">w_{hj} \leftarrow w_{hj} - \eta  \frac{\partial E}{\partial w_{hj}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-0.972108em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.972108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>对于梯度求解，一般有<strong>解析法</strong>和<strong>数值法</strong>两种方法，随着神经网络神经元增加和层数增加，直接求上万，甚至上亿个参数的解析导数变得不现实，计算量非常大。下面将介绍两种数值方式计算梯度方法：<strong>导数定义法和反向传播法</strong>。</p><h3 id="梯度计算"><a class="markdownIt-Anchor" href="#梯度计算"></a> 梯度计算</h3><p>梯度在直角坐标系下计算公式为</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla f(x) = (\frac{\partial f(x)}{\partial x_1}, \frac{\partial f(x)}{\partial x_2}, ...) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∇</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.263em;vertical-align:-0.8360000000000001em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mclose">)</span></span></span></span></span></p><p>梯度计算的结果是一个向量，并且可以看到计算梯度需要求函数对于各个自变量的偏导数。<br />对于多元函数，偏导表示自变量某个瞬间的变化量。定义为如下：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><munder><mo><mi>lim</mi><mo>⁡</mo></mo><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow></munder><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>h</mi><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">)</mo></mrow><mi>h</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial f(x_1, x_2, x_3...x_i...)}{\partial x_i}  = \lim_{h \to 0} \frac{f(x_1, x_2, x_3...x_i + h, ...)}{h} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.263em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.179108em;vertical-align:-0.7521079999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.047892em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mrel mtight">→</span><span class="mord mtight">0</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">h</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>偏导的定义和导数的定义类似，表示自变量上“微小的变化”将导致函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>的值在多大程度上发生变化。我们可以直接用程序实现上面的计算方式，程序中无法表示 h 趋近 0，我们使用一个微小值代替，计算近似解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数值梯度</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">numerical_gradient</span><span class="params">(f, x)</span>:</span></span><br><span class="line">    h = <span class="number">1e-4</span> <span class="comment"># 0.0001</span></span><br><span class="line">    grad = np.zeros_like(x)  <span class="comment"># 生成和x形状相同的数组</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> range(x.size):</span><br><span class="line">        tmp_val = x[idx]</span><br><span class="line">        <span class="comment"># 计算f(x+h)</span></span><br><span class="line">        x[idx] = tmp_val + h</span><br><span class="line">        fxh1 = f(x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算f(x-h)</span></span><br><span class="line">        x[idx] = tmp_val - h</span><br><span class="line">        fxh2 = f(x)</span><br><span class="line"></span><br><span class="line">        grad[idx] = (fxh1 - fxh2) / (<span class="number">2</span>*h)</span><br><span class="line">        x[idx] = tmp_val <span class="comment"># 还原x的值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> grad</span><br></pre></td></tr></table></figure><p>上面程序实现的偏导数方式和上面公式稍有不同，使用中心差分，误差比<strong>前向差分</strong>小，学过微积分的同学应该能够明白。虽然上面求偏导数看着很方便很简单，但是根据上面的方式计算梯度在面对神经网络这种具有很大规模输入和很大规模参数时，计算效率相当慢。下面将重点介绍反向传播算法计算梯度。（介绍完反向传播算法后，还会再介绍两者求解方式差异，为什么上面方式求解梯度速度在神经网络应用上效率太慢）</p><h3 id="计算图"><a class="markdownIt-Anchor" href="#计算图"></a> 计算图</h3><p>为了更精确地描述反向传播算法，我们使用计算图（computational graph）语言来描述一系列操作。《深度学习》花书和斯坦福李飞飞 cs231n 课程对于计算图表示上有些区别，但都表示同一个含义，即用图的方式形式化地将操作次序表示出来，方便理解。这里我们介绍 cs231n 课程对于计算图的画法。<br /><img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/simple_compute_graph.png" alt="简单计算图示例" /><br />使用圆圈代表操作节点，指向节点的箭头代表输入变量，从节点指出的箭头代表操作完后输出的变量。上面计算图即表示了<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo stretchy="false">)</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">f(x,y,z) = (x + y)z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span>。</p><h3 id="反向传播算法"><a class="markdownIt-Anchor" href="#反向传播算法"></a> 反向传播算法</h3><h4 id="简单标量反向传播算法"><a class="markdownIt-Anchor" href="#简单标量反向传播算法"></a> 简单标量反向传播算法</h4><p>上面计算图真实值计算线路展示了计算的视觉化过程。前向传播从输入计算到输出（绿色），反向传播从尾部开始，根据链式法则递归地向前计算梯度（显示为红色），一直到网络的输入端。可以认为，梯度是从计算链路中回流。<br />如上图计算过程，可以用下面几个中间过程合成：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">q = x + y </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><mi>q</mi><mo>×</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">f = q \times z </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span></span></p><p>在输入<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mi>y</mi><mo>=</mo><mn>5</mn><mo separator="true">,</mo><mi>z</mi><mo>=</mo><mo>−</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">x = -2, y = 5, z = -4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">4</span></span></span></span>情况下，箭头下面红色数字代表 f 对该处变量的偏导，即</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{\partial f}{\partial f} = 1 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mo stretchy="false">(</mo><mi>q</mi><mo>×</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow></mfrac><mo>=</mo><mi>z</mi><msub><mi mathvariant="normal">∣</mi><mrow><mi>z</mi><mo>=</mo><mo>−</mo><mn>4</mn></mrow></msub><mo>=</mo><mo>−</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">\frac{\partial f}{\partial q} = \frac{\partial (q \times z)}{\partial q} = z\vert_{z=-4}=-4 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.30744em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">4</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mo stretchy="false">(</mo><mi>q</mi><mo>×</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac><mo>=</mo><mi>q</mi><msub><mi mathvariant="normal">∣</mi><mrow><mi>q</mi><mo>=</mo><mn>3</mn></mrow></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\frac{\partial f}{\partial z} = \frac{\partial (q \times z)}{\partial z} = q\vert_{q=3}=3 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">=</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></span></p><p>根据求导的链式法则得</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>⋅</mo><mo stretchy="false">(</mo><mo>−</mo><mn>4</mn><mo stretchy="false">)</mo><mo>⋅</mo><mn>1</mn><mo>=</mo><mo>−</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">\frac{\partial f}{\partial x} = \frac{\partial f}{\partial q}\frac{\partial q}{\partial x}=1 \cdot (-4) \cdot 1 = -4 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">4</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>⋅</mo><mo stretchy="false">(</mo><mo>−</mo><mn>4</mn><mo stretchy="false">)</mo><mo>⋅</mo><mn>1</mn><mo>=</mo><mo>−</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">\frac{\partial f}{\partial y} = \frac{\partial f}{\partial q}\frac{\partial q}{\partial y}=1 \cdot (-4) \cdot 1 = -4 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">4</span></span></span></span></span></p><p>结合上面计算图和求导的链式法则可以有以下结论：<br />“<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">输</mi><mi mathvariant="normal">出</mi><mi mathvariant="normal">结</mi><mi mathvariant="normal">果</mi><mi mathvariant="normal">对</mi><mi mathvariant="normal">某</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">变</mi><mi mathvariant="normal">量</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">偏</mi><mi mathvariant="normal">导</mi><mo>=</mo><mi mathvariant="normal">反</mi><mi mathvariant="normal">向</mi><mi mathvariant="normal">传</mi><mi mathvariant="normal">播</mi><mi mathvariant="normal">时</mi><mi mathvariant="normal">上</mi><mi mathvariant="normal">游</mi><mi mathvariant="normal">传</mi><mi mathvariant="normal">递</mi><mi mathvariant="normal">下</mi><mi mathvariant="normal">来</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">偏</mi><mi mathvariant="normal">导</mi><mi mathvariant="normal">数</mi><mo>×</mo><mi mathvariant="normal">本</mi><mi mathvariant="normal">地</mi><mi mathvariant="normal">偏</mi><mi mathvariant="normal">导</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">（</mi><mi mathvariant="normal">该</mi><mi mathvariant="normal">变</mi><mi mathvariant="normal">量</mi><mi mathvariant="normal">输</mi><mi mathvariant="normal">入</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">计</mi><mi mathvariant="normal">算</mi><mi mathvariant="normal">节</mi><mi mathvariant="normal">点</mi><mi mathvariant="normal">偏</mi><mi mathvariant="normal">导</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">）</mi></mrow><annotation encoding="application/x-tex">输出结果对某一变量的偏导 = 反向传播时上游传递下来的偏导数 \times 本地偏导数（该变量输入的计算节点偏导数）</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mord cjk_fallback">输</span><span class="mord cjk_fallback">出</span><span class="mord cjk_fallback">结</span><span class="mord cjk_fallback">果</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">某</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">导</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback">反</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">传</span><span class="mord cjk_fallback">播</span><span class="mord cjk_fallback">时</span><span class="mord cjk_fallback">上</span><span class="mord cjk_fallback">游</span><span class="mord cjk_fallback">传</span><span class="mord cjk_fallback">递</span><span class="mord cjk_fallback">下</span><span class="mord cjk_fallback">来</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">导</span><span class="mord cjk_fallback">数</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mord cjk_fallback">本</span><span class="mord cjk_fallback">地</span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">导</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">（</span><span class="mord cjk_fallback">该</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">输</span><span class="mord cjk_fallback">入</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">节</span><span class="mord cjk_fallback">点</span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">导</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">）</span></span></span></span>”<br />下面介绍稍微复杂的计算图，如下图。<br /><img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/compute_graph.png" alt="计算图" /><br />利用上面得到的结论就可以得到每个遍历的偏导数，这个计算图和上面计算图区别之处在于：在乘法节点的结果输出到两个节点，分别是除法节点和减法节点，导数反向传播时，需要将上游传递的两个导数相加，即-0.25 + 1 = 0.75 这是基于下面的定理：</p><blockquote><p>定理：若函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>=</mo><mi>φ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>v</mi><mo>=</mo><mi>ψ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">u=\varphi(t), v=\psi(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">φ</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span>在点 t 可导，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z=f(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>在点(u,v)处偏导连续，则复合函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>φ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ψ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z=f(\varphi(t),\psi(t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">φ</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>在点 t 可导，则有链式法则</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">d</mi><mi>z</mi></mrow><mrow><mi mathvariant="normal">d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">d</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">d</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">d</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">d</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\mathrm{d} z }{\mathrm{d} t} = \frac{\partial z}{\partial u} \cdot \frac{\mathrm{d} u }{\mathrm{d} t} + \frac{\partial z}{\partial v} \cdot \frac{\mathrm{d} v }{\mathrm{d} t} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">u</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></blockquote><h4 id="矩阵形式反向传播算法"><a class="markdownIt-Anchor" href="#矩阵形式反向传播算法"></a> 矩阵形式反向传播算法</h4><p>下面介绍矩阵形式计算图及反向传播公式，如下图神经网络 Affine 层。<br /><img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200628140209.png" alt="Affine层" /></p><blockquote><p>Affine 层：神经网络在正向传播中进行的矩阵的乘积运算在几何学领域被称为“仿射变换”。因此，这里将进行的仿射变换的处理称为“Affine 层”。</p></blockquote><p>神经网络中还有其他比较复杂的层，梯度推导比上面 Affine 层线性偏导数推导更为复杂，在此略过介绍及推导，但运用到的知识与上面方式类似，强烈建议自己手动推导下 Affine 层反向传播，对自己理解有帮助。</p><p>前面介绍神经网络学习策略也是一个最优化问题，即</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mtext> </mtext><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mi>E</mi><mo>=</mo><mi>φ</mi><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">loss \ function = E = \varphi(y, t) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">φ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span></p><p>损失函数/目标函数为预测值<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>和监督数据<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span>的函数，其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>是经过神经网络正向传播得到的预测值，所以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>是神经网络所有参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>的函数，那么目标函数是关于参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>的函数（凸函数），即</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mtext> </mtext><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mi>ψ</mi><mo stretchy="false">(</mo><mtext mathvariant="bold">W</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">loss \ function = \psi(\textbf{W}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">W</span></span><span class="mclose">)</span></span></span></span></span></p><p>根据梯度下降法，需要求得</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mtext mathvariant="bold">W</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial L}{\partial \textbf{W}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord text"><span class="mord textbf">W</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>这里的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>表示<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">loss function</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span></span></span></span>，也即是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>。根据上面的神经网络反向传播算法逐层传播梯度，即可以高效地求解损失函数对参数的梯度，再根据随机梯度下降法，不断更新权重参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>，最小化目标函数，完成简单神经网络的训练学习。</p><h3 id="反向传播算法特别之处"><a class="markdownIt-Anchor" href="#反向传播算法特别之处"></a> 反向传播算法特别之处</h3><p>现代的神经网络规模和层数不断增加，一个复杂的深度学习模型，可能每一层有成百量级神经元，有上百层深度，下图显示一个较复杂的神经网络。<br /><img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/Snipaste_2020-06-28_15-24-37.png" alt="深层神经网络" /><br />如果采用导数定义方式，即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><msub><mo><mi>lim</mi><mo>⁡</mo></mo><mrow><mi>w</mi><mo>→</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>w</mi><mo>+</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><mi>w</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial L(w)}{\partial w} = \lim_{w \to 0} \frac{f(w + h)}{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault mtight">L</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mop"><span class="mop">lim</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mrel mtight">→</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">h</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>求解，那么在求解每一个权重（即一条连接边）参数的偏导数时神经网络都需要向前传递一次，可以看到因为越靠后的神经元被重复计算的次数就越多，随着神经元个数和层数的增加，这将会是个<strong>指数增加</strong>的<strong>时间复杂度</strong>。然而，利用了函数求导的链式法则，从输出层到输入层逐层计算模型参数的梯度值，可以看到按照这个方向计算梯度，各个神经单元只计算了一次，没有重复计算。这个计算方向能够高效的根本原因是：在计算梯度时前面的单元是依赖后面的单元的计算，而“从后向前”的计算顺序正好“解耦”了这种依赖关系，先算后面的单元，并且<strong>记住后面单元的梯度值</strong>，计算前面单元的梯度时就可以充分利用已经计算出来的结果，避免了重复计算。</p><h3 id="总结与思考"><a class="markdownIt-Anchor" href="#总结与思考"></a> 总结与思考</h3><p>如今人工智能领域中最重要的算法——反向传播算法其主要思想本质也是利用了<strong>动态规划</strong>，这种方法结合了<strong>解析法</strong>计算梯度和<strong>数值法</strong>计算梯度，利用空间换取时间，缩短求解大量参数梯度的时间，从而加速神经网络的训练。反向传播算法看上去高大上，但也不见得是用了多高级的方法和高深的知识。</p><p>参考资料：<br /><a href="https://zh.wikipedia.org/wiki/%E6%84%9F%E7%9F%A5%E5%99%A8" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/感知器</a><br /><a href="https://zh.wikipedia.org/wiki/%E4%BA%BA%E5%B7%A5%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/人工神经网络</a><br /><a href="https://www.cnblogs.com/subconscious/p/5058741.html" target="_blank" rel="noopener">https://www.cnblogs.com/subconscious/p/5058741.html</a><br />《Deep Learning form Scratch》<br />《深度学习》<br />周志华《机器学习》<br />《深度学习[花书]》<br />李航《统计学习方法》</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>我使用的 macOS 应用</title>
      <link href="/2020/05/31/%E6%88%91%E4%BD%BF%E7%94%A8%E7%9A%84-macOS-%E5%BA%94%E7%94%A8/"/>
      <url>/2020/05/31/%E6%88%91%E4%BD%BF%E7%94%A8%E7%9A%84-macOS-%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>使用macbook pro已经有两年了，不得不说mac下的很多功能和操作都非常方便。下面列举下我在macOS上常使用到的软件，整理下，也借这个机会给刚开始接触macOS的朋友一个参考。</p><h3 id="microsoft-edge"><a class="markdownIt-Anchor" href="#microsoft-edge"></a> Microsoft Edge</h3><p>目前的主力游览器。微软基于Chromium开源项目开发的一款游览器，非常好用，我觉得可以媲美Google Chrome了，基本上从Chrome游览器换成Edge不会觉得不习惯，而且微软的UI设计很简约，看着很舒服，目前（2020.05.31）更新频率挺高，加入很多功能也挺喜欢的，值得下载并跟着更新体验体验。值得一说的是，edge游览器可以在国内不用科学上网就可以登录，包括应用商店、书签同步等，这样在不同设备上不用翻墙就可以同步了，还是挺方便的。</p><h3 id="google-chrome"><a class="markdownIt-Anchor" href="#google-chrome"></a> Google Chrome</h3><p>以前常用的游览器，不多说，开发几乎都在用。</p><h3 id="visual-studio-code"><a class="markdownIt-Anchor" href="#visual-studio-code"></a> Visual Studio Code</h3><p>一款轻量化、简洁、好看、跨平台、免费的编辑器。同时支持Windows 、 Linux和macOS等操作系统且开放源代码的代码编辑器，它支持测试，并内置了Git版本控制功能，同时也具有开发环境功能，例如代码补全、代码片段和代码重构等，可以说是微软的良心之作。 我用它来写博客，非常方便、舒服。</p><h3 id="bitwarden密码管理器"><a class="markdownIt-Anchor" href="#bitwarden密码管理器"></a> Bitwarden密码管理器</h3><p>妈妈再也不用担心我记不住密码啦~~<br />灰常好用的密码管理工具，可以让我们大脑不用记住那么多密码了。</p><h3 id="picgo"><a class="markdownIt-Anchor" href="#picgo"></a> PicGo</h3><p>一个用于快速上传图片并获取图片URL链接的工具。</p><h3 id="bob"><a class="markdownIt-Anchor" href="#bob"></a> Bob</h3><p>桌面翻译工具。</p><h3 id="snipaste"><a class="markdownIt-Anchor" href="#snipaste"></a> Snipaste</h3><p>小巧而且功能强大的截图工具，不仅可以快速截图，还集成了标注和贴图功能。</p><h3 id="xmind"><a class="markdownIt-Anchor" href="#xmind"></a> Xmind</h3><p>思维导图，帮助我们更好更轻松梳理阅读或者大脑的思路。</p><h3 id="typora"><a class="markdownIt-Anchor" href="#typora"></a> typora</h3><p>好用简洁的markdown工具。</p><h3 id="wiresshark"><a class="markdownIt-Anchor" href="#wiresshark"></a> WiresShark</h3><p>一个强大的网络封包分析软件。</p><h3 id="intellij-idea"><a class="markdownIt-Anchor" href="#intellij-idea"></a> IntelliJ IDEA</h3><p>JetBrains为java开发者打造最高效智能的java IDE开发工具，IntelliJ在业界被公认为最好的java开发工具。</p><h3 id="clion"><a class="markdownIt-Anchor" href="#clion"></a> Clion</h3><p>JetBrains 推出的全新的 C/C++ 跨平台集成开发环境。</p><h3 id="postman"><a class="markdownIt-Anchor" href="#postman"></a> Postman</h3><p>一款简单实用的接口测试工具。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>数据库之SQL</title>
      <link href="/2020/05/09/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B9%8BSQL/"/>
      <url>/2020/05/09/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B9%8BSQL/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>科学上网:谷歌免费云服务器Google Cloud 搭建v2ray服务器详细教程</title>
      <link href="/2020/05/02/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91-%E8%B0%B7%E6%AD%8C%E5%85%8D%E8%B4%B9%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8Google-Cloud-%E6%90%AD%E5%BB%BAv2ray%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/"/>
      <url>/2020/05/02/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91-%E8%B0%B7%E6%AD%8C%E5%85%8D%E8%B4%B9%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8Google-Cloud-%E6%90%AD%E5%BB%BAv2ray%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h3 id="你需要准备"><a class="markdownIt-Anchor" href="#你需要准备"></a> 你需要准备</h3><ul><li>一台可以翻墙的电脑。（需要的流量并不多，推荐蓝灯，目前2020.05.02还能用，速度也可以）</li><li>一张全币种信用卡，谷歌云注册的时候，会从你的信用卡收取一美金证明你不是机器人。（推荐招行信用卡）</li><li>linux系统命令行基础知识。</li></ul><hr /><h3 id="vpn-v2ray-bbr介绍可以跳过"><a class="markdownIt-Anchor" href="#vpn-v2ray-bbr介绍可以跳过"></a> vpn、v2ray、bbr介绍（可以跳过）</h3><h4 id="vpn介绍"><a class="markdownIt-Anchor" href="#vpn介绍"></a> vpn介绍</h4><blockquote><p>虚拟私人网络（英语：Virtual Private Network，缩写：VPN）是一种常用于连接中、大型企业或团体与团体间的私人网络的通讯方法。它利用隧道协议（Tunneling Protocol）来达到发送端认证、消息保密与准确性等功能。 来自 <a href="https://zh.wikipedia.org/wiki/%E8%99%9B%E6%93%AC%E7%A7%81%E4%BA%BA%E7%B6%B2%E8%B7%AF" target="_blank" rel="noopener">维基百科-vpn</a></p></blockquote><h4 id="v2ray介绍"><a class="markdownIt-Anchor" href="#v2ray介绍"></a> v2ray介绍</h4><blockquote><p>v2ry是一款非常优秀的跨境上网工具，性能更好，支持多协议，传输层支持TCP、mKCP、WebSocket等， v2ry 的节点可以伪装成正常的网站，将其流量与正常的网页流量混淆，以避开第三方干扰，所以具有更强的隐蔽性，从而实现稳如狗的跨境上网体验，再也不用担心被封ip了。</p></blockquote><h4 id="bbr介绍"><a class="markdownIt-Anchor" href="#bbr介绍"></a> bbr介绍</h4><blockquote><p>TCP使用多种拥塞控制策略来避免雪崩式拥塞。TCP会为每条连接维护一个“拥塞窗口”来限制可能在端对端间传输的未确认分组总数量。这类似TCP流量控制机制中使用的滑动窗口。TCP在一个连接初始化或超时后使用一种“慢启动”机制来增加拥塞窗口的大小。TCP BBR（Bottleneck Bandwidth and Round-trip propagation time）是由Google设计，于2016年发布的拥塞算法。以往大部分拥塞算法是基于丢包来作为降低传输速率的信号，而BBR则基于模型主动探测。 来自 <a href="https://zh.wikipedia.org/wiki/TCP%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6#TCP_BBR" target="_blank" rel="noopener">维基百科-TCP拥塞控制</a></p></blockquote><h4 id="ssh介绍"><a class="markdownIt-Anchor" href="#ssh介绍"></a> ssh介绍</h4><blockquote><p>Secure Shell（安全外壳协议，简称SSH）是一种加密的网络传输协议，可在不安全的网络中为网络服务提供安全的传输环境[1]。SSH通过在网络中创建安全隧道来实现SSH客户端与服务器之间的连接[2]。虽然任何网络服务都可以通过SSH实现安全传输，SSH最常见的用途是远程登录系统，人们通常利用SSH来传输命令行界面和远程执行命令。SSH以非对称加密实现身份验证。来自<a href="https://zh.wikipedia.org/wiki/Secure_Shell" target="_blank" rel="noopener">维基百科-Secure Shell</a></p></blockquote><hr /><h3 id="申请免费云"><a class="markdownIt-Anchor" href="#申请免费云"></a> 申请免费云</h3><ol><li>找个<strong>临时科学上网</strong>的工具，保证可以使用三小时，尽量选择稳定一些，推荐<a href="https://github.com/getlantern/lantern" target="_blank" rel="noopener">github-lantern</a>，蓝灯可以给用户免费流量和时长，并且不用注册就可以使用。</li><li>申请google账号。小米手机在应用商店下载<strong>谷歌安装器</strong>，安装器会自动下载google框架，比较方便，注册google账号。(笔者一开始用电脑注册谷歌账号，但是谷歌需要手机号来验证，试了三个手机号都显示已经使用过了，没法通过验证。根据v友提示，使用带<strong>Google框架的Android机注册</strong>，可以成功。)</li><li>使用可以科学上网的电脑，登陆<a href="https://console.cloud.google.com/" target="_blank" rel="noopener">谷歌云</a>，点击<strong>免费试用</strong>。</li><li>可以看看google新账号获得300赠金并且在你没有升级账号前是不会收取其他费用的。 <img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/Snip20200505_1.png" alt="免费声明" /></li><li>选择<strong>国家/地区</strong>，这里google已经不在提供china选项了，所以国内的支付方式已经没办法使用了，这也是为什么需要准备一张全币信用卡的原因，这里选择<strong>美国</strong>。（截止2020.05.05双币信用卡也不能使用了）<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/Snip20200505_2.png" alt="免费试用第一步" /></li><li>填写个人信息，这里因为之前选择的地区是美国，所以要填写<strong>美国地址</strong>，可以使用这个<a href="http://www.shenfendaquan.com/" target="_blank" rel="noopener">工具</a>生成虚拟美国地址。添加全币信用卡，信用卡验证码为信用卡背面最后三位。<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/Snipaste_2020-05-05_20-56-00.png" alt="免费试用第二步" /></li><li>如果成功确认后，可以看到下面的提示：<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200505231521.png" alt="免费试用确认成功" /></li></ol><h3 id="申请虚拟机vps"><a class="markdownIt-Anchor" href="#申请虚拟机vps"></a> 申请虚拟机vps</h3><ol><li>按照下图进入虚拟机实例界面，点击<strong>创建</strong>：<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200505232148.png" alt="创建实例第一步" />  <img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200505232413.png" alt="创建实例第二步" /></li><li>实例名默认就行，选择<strong>台湾节点</strong>（根据测试台湾节点速度比较快些），选择<strong>最小内存</strong>（图中不是最小内存）就够了，google虚拟机流量单独收费，300￥中需要有相当一部分用作购买流量。<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200505232645.png" alt="实例配置一" /> <img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200505233341.png" alt="实例配置二" /></li><li>配置<strong>静态ip</strong>，静态ip在创建实例时可以配置或者实例创建完后配置，如下图：<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200505233506.png" alt="静态ip配置一" /> 进入外部ip列表，<strong>类型</strong>如果是临时ip会有选项选择<strong>静态</strong>。<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200505233956.png" alt="静态ip配置二" /></li><li>配置<strong>防火墙规则</strong>，配置如下图两条规则，**注意：**ip范围为：0.0.0.0/0。<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200505234534.png" alt="配置防火墙规则" /></li><li><strong>重要！重要！重要！</strong> 注意：申请完静态ip，并且成功绑定到实例上后，过上大概三五分钟，测试下ip地址是否可用，这个可用指的是有没有被封掉，通过ping能否成功可以检测，推荐<a href="http://ping.pe/" target="_blank" rel="noopener">ping工具</a>进行检测（可能需要科学上网才可以进）。如果全报红，过一段时间再测试，可能刚绑定到实例上不稳定；如果显示中国地区无法ping通，则很可能被封掉了。</li><li><strong>重要！！！</strong> 如果静态ip被封掉，可以根据申请虚拟机的1-5步骤重新申请虚拟机绑定静态ip，一定要让申请到的静态ip可以使用。最后将不需要的虚拟机实例删掉就好。</li></ol><h3 id="ssh远程登陆"><a class="markdownIt-Anchor" href="#ssh远程登陆"></a> ssh远程登陆</h3><ol><li>先使用google提供的<strong>游览器ssh</strong>登陆，如下图：<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200506095444.png" alt="游览器ssh登陆" /></li><li>找到本机ssh的<strong>公钥</strong>复制，即将下面打码的长字符串部分复制：<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200506095820.png" alt="复制本机公钥" /></li><li>编辑vps上的<strong>authorized_keys</strong>，将上面复制的公钥添加到里面。<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200506100256.png" alt="配置vps公钥" /></li><li>正确保存后，本机就可以直接使用ssh登陆了，非常方便不需要输入密码，如下图：<img src="https://gitee.com/qiyueliuhuogitee/blogimages/raw/master/img/20200506100823.png" alt="远程登陆" /></li></ol><h3 id="注册域名"><a class="markdownIt-Anchor" href="#注册域名"></a> 注册域名</h3><p>用v2ray的节点伪装正常的网站，所以需要有域名了，不过这个域名随便注册一个即可，有域名可以直接使用已有的，建议在<a href="https://www.namesilo.com/" target="_blank" rel="noopener">namesilo</a>购买，不需要实名认证。<br />注册域名略过，不同网站注册域名大同小异，<strong>记着一定要将域名解析到申请的虚拟机的静态ip</strong>。</p><h3 id="v2ray部署"><a class="markdownIt-Anchor" href="#v2ray部署"></a> v2ray部署</h3><p>使用一键安装脚本安装v2ray</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -L -s https://raw.githubusercontent.com/wulabing/V2Ray_ws-tls_bash_onekey/master/install.sh) | tee v2ray_ins.log</span><br></pre></td></tr></table></figure><p>安装过程及客户端安装参考<a href="https://www.ectrv.com/?p=153" target="_blank" rel="noopener">此教程</a></p><h3 id="bbr加速"><a class="markdownIt-Anchor" href="#bbr加速"></a> bbr加速</h3><p>仅仅安装v2ray，跨境上网的速度并不快，比如看youtube视频会卡，所以请务必再安装谷歌开发的<strong>加速器BBR</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 下载bbr安装脚本</span></span><br><span class="line">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将脚本变成可执行</span></span><br><span class="line">chmod +x bbr.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 运行脚本</span></span><br><span class="line">./bbr.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看bbr是否安装成功</span></span><br><span class="line">lsmod | grep bbr</span><br></pre></td></tr></table></figure><h3 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h3><p>将v2ray部署完成后并且将其中的url链接导入到v2ray客户端，连接就可以使用了。速度还可以，看看视频，游览网页完全可以满足。将客户端设置成PAC模式，可以判断访问外网还是国内网站，智能分流。</p><p>友情链接：<a href="https://dlj.tf/fvS3In" target="_blank" rel="noopener">付费机场推荐</a></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 科学上网 </tag>
            
            <tag> 谷歌 </tag>
            
            <tag> 云服务器 </tag>
            
            <tag> 外网 </tag>
            
            <tag> 免费 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo编辑实时游览器显示插件browsersync</title>
      <link href="/2020/04/04/hexo%E7%BC%96%E8%BE%91%E5%AE%9E%E6%97%B6%E6%B8%B8%E8%A7%88%E5%99%A8%E6%98%BE%E7%A4%BA%E6%8F%92%E4%BB%B6browsersync/"/>
      <url>/2020/04/04/hexo%E7%BC%96%E8%BE%91%E5%AE%9E%E6%97%B6%E6%B8%B8%E8%A7%88%E5%99%A8%E6%98%BE%E7%A4%BA%E6%8F%92%E4%BB%B6browsersync/</url>
      
        <content type="html"><![CDATA[<p>用VScode编辑文章虽然很方便，但是VScode里面自带的实时显示文章（所谓的所见即所得）总觉得不怎么好看，想起来之前在公司里面偶尔修改些前端代码，好像有办法实时显示修改。现在前端开发有很多好用的工具，可以一边修改代码一边运行，实时显示在游览器。于是，网上搜索了下就找到这个插件，非常好用。</p><h3 id="browsersync介绍及作用"><a class="markdownIt-Anchor" href="#browsersync介绍及作用"></a> browsersync介绍及作用</h3><p>browsersync能让浏览器实时、快速响应您的文件更改（html、js、css、sass、less等）并自动刷新页面。更重要的是Browsersync可以同时在PC、平板、手机等设备下进项调试。官网 <a href="http://www.browsersync.cn/" target="_blank" rel="noopener">browsersync</a>，省时的浏览器同步测试工具，确实很方便很强大。</p><h3 id="如何在-hexo-中使用-browsersync"><a class="markdownIt-Anchor" href="#如何在-hexo-中使用-browsersync"></a> 如何在 Hexo 中使用 browsersync</h3><p>我是在VScode中编辑文章，安装browsersync直接在任何一个命令行中运行以下：</p><ul><li>第一步<ul><li>打开 cmd 或 git 切换到你的 blog 主目录下</li></ul></li><li>第二步<ul><li>执行 $ npm install hexo-browsersync --save</li></ul></li><li>第三步<ul><li>执行 $ hexo server</li></ul></li><li>第四步<ul><li>访问 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> ,开始编写你的代码或文档</li></ul></li></ul><p>执行完上述步骤,你可以一边编写源文档,一边查看编译后的文档</p><p>当你编写并调试完后，关闭 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> 之后,还需要执行 $ hexo deploy --generate,刷新你的博客页面,这样你的文章就上传了。</p><p>参考： <a href="https://www.dazhuanlan.com/2019/12/26/5e04219a60b20/" target="_blank" rel="noopener">https://www.dazhuanlan.com/2019/12/26/5e04219a60b20/</a></p>]]></content>
      
      
      <categories>
          
          <category> 技术 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>《人性的弱点》笔记</title>
      <link href="/2019/05/19/%E3%80%8A%E4%BA%BA%E6%80%A7%E7%9A%84%E5%BC%B1%E7%82%B9%E3%80%8B%E7%AC%94%E8%AE%B0/"/>
      <url>/2019/05/19/%E3%80%8A%E4%BA%BA%E6%80%A7%E7%9A%84%E5%BC%B1%E7%82%B9%E3%80%8B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="第一章-待人处世的基本技巧"><a class="markdownIt-Anchor" href="#第一章-待人处世的基本技巧"></a> 第一章 待人处世的基本技巧</h3><blockquote><p>只有那些不够明智的人才会去批评、职责和抱怨他人。的确，很多蠢人都这么做。与其抱怨、责备，不如多一些理解，设身处地地为他们想想，为什么他们会这么做，这样做比批评更加有益，而且这样，就会使我们产生同情、容忍、仁慈之心。</p></blockquote><ul><li>无端指责别人并不能解决问题</li><li>批评是徒劳的，因为它会使人过于保守，并常使他竭力的证明自己。批评也是危险的，因为它伤害一个人宝贵的自尊心，伤害他的自重感，并激起他的反抗。</li><li>人类的天性就是如此，做错事的人只会责备别人而不会责备自己。</li><li>我们要明白批评就好像是家鸽，它们总会飞回家。我们应该明白我们要矫正及谴责的人都会为他自己辩护，从而反过来谴责我们。</li><li>每个人都喜欢被人恭维。</li><li>寻求自重感的欲望是人类与动物的主要差别之一。</li><li>有的人甚至用装病来得到别人的同情、注意及自重感。</li><li>如果有所谓的成功的秘诀的话，那就是你站在对方的立场，由他的观点看事，同时兼顾自己的观点。</li><li>能设身于他人处境的人，能了解他们心理活动的人是不必为他们的前途顾虑的。</li></ul><h3 id="第二章-如何使人喜欢你"><a class="markdownIt-Anchor" href="#第二章-如何使人喜欢你"></a> 第二章 如何使人喜欢你</h3><blockquote><p>关于成功的商业交往，没有什么神秘的——专心注意对你讲话的人、静静地倾听、记得比人的名字、没有别的东西会让人如此开心。当然，你也应该意识到，我们经常是因为自身的特点而不是优点招人喜欢。</p></blockquote><ul><li>我们都知道，有的人，这一生都在错误地让别人对他们自己感兴趣。当然，这是不行的。他们对你不感兴趣，他们对我也不感兴趣。他们只对他们自己感兴趣，不论早晨、中午，还是晚饭后。</li><li>对别人不感兴趣的人，生活中遭遇的困难最大，对别人造成的损害也最大，所有的人类失败，都在这些人身上发生。</li><li>我们对别人的事情感兴趣，别人才会对我们的事情感兴趣。</li><li>真诚是必不可少的，要培养真正的友谊，或是帮助别人又帮助自己，那么就要记着，对你身边的人和事表现出足够的关心。</li><li>世界上每个人都在寻求快乐——但是只有一个方法可以确实地得到快乐，那就是自己控制自己的思想。</li><li>如果你不照着去做，阅读是不会给你带来任何效果的。</li><li>思想是至高无上的。保持一个良好的心态——勇敢、诚实、乐观的态度。</li><li>微笑表明心境很好。面露平和欢愉的微笑，说明充实满足，能善待别人。这样的人一定会感染别人，别人自然乐于与之交往。</li><li>在谈话中，他会费劲心思将别人的名字反复记忆，并在脑海中试着把这人的姓名与这人的面孔、神色及外观联系起来记忆。</li><li>所有这些事都需要花心思。艾默生说“良好的礼貌修养是从小事中积累起来的。”</li><li>记住，把这个人的名字当做是人类语言中最甜美最重要的声音来记忆。</li><li>静听是我们对别人的一种最高的恭维。</li><li>讨厌的人，他们就是——被他们自私的心及他们自重感麻痹了的讨厌的人。他们只谈论自己，只为自己设想。</li><li>如果你希望成为一个善于谈话的人，要先学会做一个注意静听的人。要使人对你感兴趣，先激发那人的兴趣。问别人喜欢回答的问题，鼓励他谈论他自己及他的成就。</li><li>通到人心的大路就是跟对方谈论他最以为宝贵的事情。</li><li>无论面对什么样的人物，一定要找到他所感兴趣的事，让他先高兴起来，这样你就比较容易接近他了。</li><li>自重的欲望是人类天性中最深刻的冲动。</li><li>曾统治过大英帝国的迪拜累利说道：“同人们谈谈他们自己，他们会愿意听上好几个钟头。”如果你真诚地这样做，你就赢得了别人的尊重。</li></ul><h3 id="第三章-如何使人信服你"><a class="markdownIt-Anchor" href="#第三章-如何使人信服你"></a> 第三章 如何使人信服你</h3><blockquote><p>如果你想赢得人心，首先要让他人相信你是他最真诚的朋友。就像有一滴蜂蜜吸引住他的心，通往他的理性。使人信服于你，你就一定要让他人感受到你的真诚。</p></blockquote><ul><li>恨不能止恨，爱能止恨。</li><li>永远不要用辩论来停止误会，应该用一些技巧、外交来和解，还要兼顾对方的观点，用恰当的方式使辩论停止。</li><li>当你指出对方的错误时，对方会因此同意你的观点吗？绝对不会！因为你直接打击了他们的智慧、判断、尊荣和自尊。</li><li>记住那句古老的谚语：“用争夺的方法，你将永远得不到满足，但用让步的方法，你可得到比你期望的更多。”如果你错了，就迅速而真诚地承认。</li><li>太阳能比风更快地使老人脱下外套，温和、友善和赞赏的态度也能使人改变心意，这是咆哮和猛烈攻击所难以奏效的。请记住林肯所说的话：“一滴蜂蜜要比一加仑的胆汁招引更多的苍蝇。”</li><li>如果你想说服别人，又不想让人感觉你是把你的观点强加给他的，那么，记住苏格拉底的话，向对方发一个温柔的问题，得到“是”的回应。</li><li>法国哲学家罗素说：“如果你想与人结仇，那你就胜过你的朋友；但如果你要得到朋友，那就让你的朋友胜过你。”</li><li>没有人喜欢强迫接受推销，或被人强迫去做一件事。我们都喜欢按照自己的想法购买东西，或按照自己的想法做事，我们很高兴别人征询我们的愿望、需求和意见。</li><li>这是一个充满戏剧化的时代，仅仅陈述事实是不够的，还需要把事实生动化、趣味化、戏剧化。你必须学会表演。电影这样做，电视这样做，如果你像被人注意，你也必须这样做。</li></ul><h3 id="第四章-如何更好地说服他人"><a class="markdownIt-Anchor" href="#第四章-如何更好地说服他人"></a> 第四章 如何更好地说服他人</h3><blockquote><p>称赞是温暖他人心灵的阳光，没有阳光，我们就没有花儿和收成。称赞会给他一种自重感，这样他就会与你保持合作，而不是背叛。</p></blockquote><ul><li>从赞扬和欣赏开始，就像理发师在替人修面之前，要先把涂上肥皂一样，可以减少被划破的可能，而赞扬和欣赏可以更好地改变和说服一个人。</li><li>对那些非常敏感的人，用巧妙的暗示，让他们改正自己的错误，会收到奇妙的效果。</li><li>在批评对方以前，首先陈述你自己的错误，比你直接批评他会产生更神奇的效果。</li><li>有时即使我们是对的，别人是错的，如果让他过于丢面子的话，只会让事情变得更糟。所以，无论何时，我们都要记住：使对方保持他的面子。这也是你有修养的体现。</li><li>当一个人收到批评时，他的能力就会降低，而当他受到鼓励时，他就会精神焕发。要“诚于嘉许，宽于称道”。</li></ul><h3 id="第五章-如何让你的家庭幸福快乐"><a class="markdownIt-Anchor" href="#第五章-如何让你的家庭幸福快乐"></a> 第五章 如何让你的家庭幸福快乐</h3><blockquote><p>在地狱中，魔鬼为了破坏爱情而发明的一定会成功而恶毒的方法中，唠叨就是很厉害的了。它永远不会失败，就像眼镜蛇咬人一样，总是具有破坏性，总是会置于人于死命。用宽容、爱和欣赏代替唠叨，才会让你的家庭更幸福。</p></blockquote><ul><li>当婚姻出现裂痕时，一定要让自己冷静下来，问问自己，是不是自己也有过错。</li><li>如果你要维持家庭生活的幸福快乐，一定要记住：“绝对绝对不可以唠叨”</li><li>如果你要家庭生活幸福快乐，一定要记住“不要想按着你的意思，来改变你的伴侣。”</li><li>和别人相处要学的第一件事，就是对于他们寻求快乐的特别方式不要加以干涉，如果这些方式并没有强烈妨碍到我们的话。</li><li>夫妻相处之道在于坦诚与体谅，世界上没有完美的配偶，但你一定要懂得经营，聪明的人懂得怎样使不可能完美的婚姻变得尽可能的完美。</li><li>多些信任和接纳，给予空间，并以行动表示谅解；多包容，多忍耐，多欣赏，少批评，少抱怨。</li><li>相互信任和包容，才是幸福婚姻的良方。</li><li>许多罗曼蒂克的梦想破灭了！50%以上的婚姻不幸福。原因之一是：毫无用处却令人心碎的批评。</li><li>对于女人在打扮美丽和穿着入时方面所花去的心思，男人应该表示出他的激赏。所有的男人，都知道女人非常注意衣着，但也常常忘记这件事。</li><li>我们男人真应该认清这点，法国上层阶级的男人，在这方面很有教养，不但对女人穿戴的衣帽表示赞美，并且在一个晚上不止赞美一次，而是好几次。五千万个法国男人都这么做，一定有他们的道理。</li><li>如果女人要从她的丈夫之处得到快乐，那一定是得自他赞赏和忠实的热爱。</li><li>无论男人或女人，都希望获得赞美和热爱。如果能够真心地表示赞赏和热爱，就会得到幸福快乐。</li><li>女人对生日，或是什么纪念日，会很重视！那是什么原因？那该是女人心理上的一个神秘的谜！</li><li>成功的关系是建立于日常的关心和爱护的基础上。所以，要想保持家庭生活快乐，一定要记住注重那些看似小事的事情。</li><li>有千万个家庭，就有千万种生活方式。虽然生活方式各不相同，但有一个准则在生活中要注意，这是生活安定平和的保证：不要忽视生活小节。</li><li>不讲理是吞食爱情的癌细胞。虽然我们都知道这一点，但糟糕的是，我们对待自己的亲人，居然赶不上对待陌生人那样有礼。</li></ul><h3 id="第六章-经营好自己的人生"><a class="markdownIt-Anchor" href="#第六章-经营好自己的人生"></a> 第六章 经营好自己的人生</h3><blockquote><p>我们已经在美好的童话国度生活了许多年，可我们一无所知，被蒙蔽住了双眼，拥有得太多，却忽略了生活真正乐趣</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> 人生 </tag>
            
            <tag> 社交 </tag>
            
            <tag> 生活 </tag>
            
            <tag> 智慧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>书籍</title>
      <link href="/2019/05/04/%E4%B9%A6%E7%B1%8D/"/>
      <url>/2019/05/04/%E4%B9%A6%E7%B1%8D/</url>
      
        <content type="html"><![CDATA[<blockquote><p>如今你的气质里，藏着你走过的路，读过的书和爱过的人。 —— 《卡萨布兰卡》</p></blockquote><p>闲来无事，把自己从高中、大学和毕业一年看过的书做一个统计，方便自己有空余时间可以将一些好的书籍反复看，毕竟有太多书籍值得反复研读，另外，也是对自己看书历程的记录，希望不断鞭策自己多读书，读好书，当然，也是方便别人对自己的了解。<br />记录必读书籍，分为已读完、正在读、未读、未读完</p><h2 id="技术与算法"><a class="markdownIt-Anchor" href="#技术与算法"></a> 技术与算法</h2><p>心得：实践、做题</p><h3 id="已读书籍"><a class="markdownIt-Anchor" href="#已读书籍"></a> 已读书籍</h3><table><thead><tr><th style="text-align:center">书名</th><th style="text-align:center">介绍</th><th style="text-align:center">阅读进度</th></tr></thead><tbody><tr><td style="text-align:center">《精通Spring 4.x  企业应用开发实战》</td><td style="text-align:center">一本比较全面且易学的spring书籍</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《鸟哥的Linux私房菜-基础学习篇》</td><td style="text-align:center">最具知名度的Linux入门书</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《架构探险：从零开始写JavaWeb框架》</td><td style="text-align:center">step by step，值得实践的好书</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《淘宝技术这十年》</td><td style="text-align:center">淘宝从小到大的技术发展历程</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《Java核心技术-卷一》</td><td style="text-align:center">系统全面讲解了Java语言</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《C++Primer第5版》</td><td style="text-align:center">C++初学者的最佳指南</td><td style="text-align:center">已读</td></tr></tbody></table><h3 id="正在读书籍"><a class="markdownIt-Anchor" href="#正在读书籍"></a> 正在读书籍</h3><table><thead><tr><th style="text-align:center">书名</th><th style="text-align:center">介绍</th><th style="text-align:center">阅读进度</th></tr></thead><tbody><tr><td style="text-align:center">《深入理解Java虚拟机 JVM高级特性与最佳实践(第二版)》</td><td style="text-align:center">java学习进阶</td><td style="text-align:center">已读2/5</td></tr><tr><td style="text-align:center">《大型分布式网站架构》</td><td style="text-align:center">原理与实践结合、分布式网站技术的全貌</td><td style="text-align:center">已读3/5</td></tr></tbody></table><h3 id="未读-未读完书籍"><a class="markdownIt-Anchor" href="#未读-未读完书籍"></a> 未读、未读完书籍</h3><table><thead><tr><th style="text-align:center">书名</th><th style="text-align:center">介绍</th><th style="text-align:center">阅读进度</th></tr></thead><tbody><tr><td style="text-align:center">《算法导论》</td><td style="text-align:center">严谨性和全面性融为一体</td><td style="text-align:center">未读完</td></tr><tr><td style="text-align:center">《机器学习》周志华</td><td style="text-align:center">西瓜书机器学习领域全面的中文入门教材</td><td style="text-align:center">未读完</td></tr><tr><td style="text-align:center">《SQL学习指南（第2版 修订版）》</td><td style="text-align:center"></td><td style="text-align:center">未读</td></tr></tbody></table><h2 id="小说-人文-励志"><a class="markdownIt-Anchor" href="#小说-人文-励志"></a> 小说、人文、励志</h2><p>心得：认同、生活指导</p><h3 id="已读书籍-2"><a class="markdownIt-Anchor" href="#已读书籍-2"></a> 已读书籍</h3><table><thead><tr><th style="text-align:center">书名</th><th style="text-align:center">介绍</th><th style="text-align:center">阅读进度</th></tr></thead><tbody><tr><td style="text-align:center">《平凡的世界》</td><td style="text-align:center">苦难转化为前行的精神动力</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《三体》</td><td style="text-align:center">仰望星空才知道自己多么渺小</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《大漠苍狼》</td><td style="text-align:center">黑洞、虫洞、穿越、时间循环</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《鬼吹灯》</td><td style="text-align:center">人点烛，鬼吹灯</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《盗墓笔记》</td><td style="text-align:center">最大的敌人不是粽子或机关，而是自身的恐惧</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《上帝掷骰子吗》</td><td style="text-align:center">与最伟大的物理学家们并肩作战，经历一次量子之旅</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《就喜欢你看不惯我又干不掉我的样子》</td><td style="text-align:center">一只叫“吾皇”的胖猫、一只叫“巴扎黑”的萌狗以及少年主人的生活趣事</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《我不喜欢这世界，我只喜欢你》</td><td style="text-align:center">一本让你相信爱情的治愈书籍</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《穆斯林的葬礼》</td><td style="text-align:center">人可以失落一切，唯独不应该失落自己。</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《撒哈拉的故事》</td><td style="text-align:center">撒哈拉生活的点点滴滴，三毛与荷西的真挚的爱情</td><td style="text-align:center">已读</td></tr><tr><td style="text-align:center">《天才在左，疯子在右》</td><td style="text-align:center"></td><td style="text-align:center">已读</td></tr></tbody></table><h3 id="正在读书籍-2"><a class="markdownIt-Anchor" href="#正在读书籍-2"></a> 正在读书籍</h3><table><thead><tr><th style="text-align:center">书名</th><th style="text-align:center">介绍</th><th style="text-align:center">阅读进度</th></tr></thead><tbody><tr><td style="text-align:center">《人性的弱点》</td><td style="text-align:center">自我教育与人际交往的人生准则</td><td style="text-align:center">已读4/5</td></tr><tr><td style="text-align:center">《非暴力沟通》</td><td style="text-align:center">观察、感受、需要、请求</td><td style="text-align:center">已读2/5</td></tr><tr><td style="text-align:center">《羊皮卷》</td><td style="text-align:center">超越自我，砥砺前行</td><td style="text-align:center">已读0/5</td></tr></tbody></table><h3 id="未读-未读完书籍-2"><a class="markdownIt-Anchor" href="#未读-未读完书籍-2"></a> 未读、未读完书籍</h3><table><thead><tr><th style="text-align:center">书名</th><th style="text-align:center">介绍</th><th style="text-align:center">阅读进度</th></tr></thead><tbody><tr><td style="text-align:center">《金字塔原理》</td><td style="text-align:center"></td><td style="text-align:center">未读</td></tr><tr><td style="text-align:center">《三体Ⅱ·黑暗森林》</td><td style="text-align:center"></td><td style="text-align:center">未读</td></tr><tr><td style="text-align:center">《少有人走的路》</td><td style="text-align:center"></td><td style="text-align:center">未读</td></tr><tr><td style="text-align:center">《哲学家们都干了些什么》</td><td style="text-align:center"></td><td style="text-align:center">未读</td></tr><tr><td style="text-align:center">《佛祖都说了些什么》</td><td style="text-align:center"></td><td style="text-align:center">未读</td></tr><tr><td style="text-align:center">《学会提问》</td><td style="text-align:center"></td><td style="text-align:center">未读</td></tr><tr><td style="text-align:center">《经济学原理》曼昆版本</td><td style="text-align:center"></td><td style="text-align:center">未读</td></tr></tbody></table><h2 id="理财"><a class="markdownIt-Anchor" href="#理财"></a> 理财</h2><p>心得：长期</p><h3 id="已读书籍-3"><a class="markdownIt-Anchor" href="#已读书籍-3"></a> 已读书籍</h3><table><thead><tr><th style="text-align:center">书名</th><th style="text-align:center">介绍</th><th style="text-align:center">阅读进度</th></tr></thead><tbody><tr><td style="text-align:center">《小狗钱钱》</td><td style="text-align:center">财富启蒙读物，改变自己对于财富的观念</td><td style="text-align:center">已读4/5</td></tr></tbody></table><h3 id="未读-未读完书籍-3"><a class="markdownIt-Anchor" href="#未读-未读完书籍-3"></a> 未读、未读完书籍</h3><table><thead><tr><th style="text-align:center">书名</th><th style="text-align:center">介绍</th><th style="text-align:center">阅读进度</th></tr></thead><tbody><tr><td style="text-align:center">《漫步华尔街》</td><td style="text-align:center"></td><td style="text-align:center">未读</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>阅读书籍应该有的态度</title>
      <link href="/2019/03/31/%E9%98%85%E8%AF%BB%E4%B9%A6%E7%B1%8D%E5%BA%94%E8%AF%A5%E6%9C%89%E7%9A%84%E6%80%81%E5%BA%A6/"/>
      <url>/2019/03/31/%E9%98%85%E8%AF%BB%E4%B9%A6%E7%B1%8D%E5%BA%94%E8%AF%A5%E6%9C%89%E7%9A%84%E6%80%81%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<p>忘记在哪本书上看到的，当时保存了图片，觉得很有道理，现在摘抄下，也提醒自己。</p><h3 id="1-慢一点你理解的越多需要记的就越少"><a class="markdownIt-Anchor" href="#1-慢一点你理解的越多需要记的就越少"></a> 1. 慢一点，你理解的越多，需要记的就越少</h3><blockquote><p>不要光是看看就行了。停下来，好好想一想。书中提出问题的时候，你不要直接去翻答案。可以假想真的有人在问你这个问题。你让大脑想得越深入，就越有可能学会并记住它。</p></blockquote><h3 id="2-做练习自己记笔记"><a class="markdownIt-Anchor" href="#2-做练习自己记笔记"></a> 2. 做练习，自己记笔记</h3><blockquote><p>不要只是坐在那里看着练习发呆。拿出笔来，写一写画一画。大量研究都证实，学习过程中如果能实际动动手，将改善你的学习。</p></blockquote><h3 id="3-阅读没有傻问题部分"><a class="markdownIt-Anchor" href="#3-阅读没有傻问题部分"></a> 3. 阅读“没有傻问题”部分</h3><blockquote><p>顾明思义。这些问题不是可有可无的旁注，它们绝对是核心内容的一部分！千万不要跳过去不看。</p></blockquote><h3 id="4-上床睡觉之前不要再看别的书至少不要看其他有难度的东西"><a class="markdownIt-Anchor" href="#4-上床睡觉之前不要再看别的书至少不要看其他有难度的东西"></a> 4. 上床睡觉之前不要再看别的书，至少不要看其他有难度的东西</h3><blockquote><p>学习中有一部分是在你合上书之后完成的（特别是，要把学到的知识长久地记住，这往往无法在看书的过程中做到）。你的大脑也需要有自己的时间，这样才能再做一些处理。如果在这段处理时间内你又往大脑里灌输了新的知识。那么你刚才学的一些东西就会丢掉。</p></blockquote><h3 id="5-要喝水而且要多喝一点水"><a class="markdownIt-Anchor" href="#5-要喝水而且要多喝一点水"></a> 5. 要喝水，而且要多喝一点水</h3><blockquote><p>能提供充足的液体，你的大脑才能有最佳表现。如果缺水（可能在你感觉到口渴之前就已经缺水了），学习能力就会下降。</p></blockquote><h3 id="6-讲出来而且要大声讲出来"><a class="markdownIt-Anchor" href="#6-讲出来而且要大声讲出来"></a> 6. 讲出来，而且要大声讲出来</h3><blockquote><p>说话可以刺激大脑的另一部分。如果你想看懂什么，或者想更牢地记住它，就要大声地说出来。更好的办法是，大声地解释给别人听。这样你会学得更快，而且可能会新的发现，这是以前光看不说的时候所没有的。</p></blockquote><h3 id="7-听听你的大脑怎么说"><a class="markdownIt-Anchor" href="#7-听听你的大脑怎么说"></a> 7. 听听你的大脑怎么说</h3><blockquote><p>注意一下你的大脑是不是负担太重了。如果发现自己开始浮光</p></blockquote><h3 id="8-要有点感觉"><a class="markdownIt-Anchor" href="#8-要有点感觉"></a> 8. 要有点感觉</h3><blockquote><p>你的大脑需要知道这是很重要的东西。要真正融入到书中的故事里。为书里的照片加上你自己的图题。你可能觉得一个笑话很蹩脚，不太让人满意，但这总比根本无动于衷要好。</p></blockquote><h3 id="9-真正做些工作"><a class="markdownIt-Anchor" href="#9-真正做些工作"></a> 9. 真正做些工作</h3><blockquote><p>把这些知识应用到你的日常工作中去，利用你所学的方法完成项目决策。具体做些工作，你会得到书中练习和活动以外的经验。</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>PyCharm之Matplotlib不显示图像(for Mac)</title>
      <link href="/2019/03/23/PyCharm%E4%B9%8BMatplotlib%E4%B8%8D%E6%98%BE%E7%A4%BA%E5%9B%BE%E5%83%8F-for-Mac/"/>
      <url>/2019/03/23/PyCharm%E4%B9%8BMatplotlib%E4%B8%8D%E6%98%BE%E7%A4%BA%E5%9B%BE%E5%83%8F-for-Mac/</url>
      
        <content type="html"><![CDATA[<p>问题：python virtualenv创建独立环境中 Matplotlib不显示图像(for Mac)</p><h3 id="系统版本"><a class="markdownIt-Anchor" href="#系统版本"></a> 系统版本</h3><p>MacOS Mojave 10.14.1</p><h3 id="解决"><a class="markdownIt-Anchor" href="#解决"></a> 解决</h3><p>试了上面文章的几种解决方法后还是没法解决，网上找了一大堆文章，还是没有解决，之后还是在stackoverflow中看到一种可能的问题，附上链接https://stackoverflow.com/questions/22304215/gtk-backend-requires-pygtk-to-be-installed，当看到有答主给出这个解决方式$ virtualenv --system-site-packages ~/.virtualenvs/my_env 才想起来之前创建python运行环境时运行了这个virtualenv -p /usr/bin/python --no-site-packages venv，参数–no-site-packages 代表系统Python环境中的所有第三方包都不会复制过来，删掉venv目录，重新运行 virtualenv -p /usr/bin/python --system-site-packages venv 后，再安装matplotlib库可以显示图片</p><h3 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h3><ul><li><strong>继承本机的pyhon环境后不用再装matplotlib了</strong></li><li><strong>猜测：virtualenv中如果在装matplotlib会覆盖mac预装好的matplotlib</strong></li><li><strong>注意：安装其他包时不要在venv环境下site-package目录下引入matplotlib</strong></li></ul><h3 id="自己维护python包版本还是太麻烦了所以最后还是安装anaconda了"><a class="markdownIt-Anchor" href="#自己维护python包版本还是太麻烦了所以最后还是安装anaconda了"></a> 自己维护python包版本还是太麻烦了，所以最后还是安装anaconda了。</h3>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那两个整数，并返回他们的数组下标。</title>
      <link href="/2019/03/04/%E7%BB%99%E5%AE%9A%E4%B8%80%E4%B8%AA%E6%95%B4%E6%95%B0%E6%95%B0%E7%BB%84-nums-%E5%92%8C%E4%B8%80%E4%B8%AA%E7%9B%AE%E6%A0%87%E5%80%BC-target%EF%BC%8C%E8%AF%B7%E4%BD%A0%E5%9C%A8%E8%AF%A5%E6%95%B0%E7%BB%84%E4%B8%AD%E6%89%BE%E5%87%BA%E5%92%8C%E4%B8%BA%E7%9B%AE%E6%A0%87%E5%80%BC%E7%9A%84%E9%82%A3%E4%B8%A4%E4%B8%AA%E6%95%B4%E6%95%B0%EF%BC%8C%E5%B9%B6%E8%BF%94%E5%9B%9E%E4%BB%96%E4%BB%AC%E7%9A%84%E6%95%B0%E7%BB%84%E4%B8%8B%E6%A0%87%E3%80%82/"/>
      <url>/2019/03/04/%E7%BB%99%E5%AE%9A%E4%B8%80%E4%B8%AA%E6%95%B4%E6%95%B0%E6%95%B0%E7%BB%84-nums-%E5%92%8C%E4%B8%80%E4%B8%AA%E7%9B%AE%E6%A0%87%E5%80%BC-target%EF%BC%8C%E8%AF%B7%E4%BD%A0%E5%9C%A8%E8%AF%A5%E6%95%B0%E7%BB%84%E4%B8%AD%E6%89%BE%E5%87%BA%E5%92%8C%E4%B8%BA%E7%9B%AE%E6%A0%87%E5%80%BC%E7%9A%84%E9%82%A3%E4%B8%A4%E4%B8%AA%E6%95%B4%E6%95%B0%EF%BC%8C%E5%B9%B6%E8%BF%94%E5%9B%9E%E4%BB%96%E4%BB%AC%E7%9A%84%E6%95%B0%E7%BB%84%E4%B8%8B%E6%A0%87%E3%80%82/</url>
      
        <content type="html"><![CDATA[<h3 id="题目描述"><a class="markdownIt-Anchor" href="#题目描述"></a> 题目描述</h3><p>给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那两个整数，并返回他们的数组下标。你可以假设每种输入只会对应一个答案。但是，你不能重复利用这个数组中同样的元素。</p><h3 id="思路"><a class="markdownIt-Anchor" href="#思路"></a> 思路：</h3><ol><li>题目是要求nums中有两个数和是target，那么就应该是nums中会存在一个target - nums[i]的数，这种变换思维是要具备，即当题目需要得到什么结果，将这个结果推到出等价的描述，得到一些充分条件或者必要条件，在想办法（算法）去得到这些条件，当然也要具备一些基础知识，比如hash思想，知道hash方法它有哪些应用场景和它还有可能解决什么问题。</li><li>题目转换为nums中找到一个target - nums[i]的数，那么可以先得到这些target - nums[i]，即得到两个nums.length大小的数组，再去找到两个数组中相同的数，找到相同的数，最容易的方法就是通过hash思想，有很多类似找相同数或者元素都有借助hash思想。</li></ol><h3 id="答案"><a class="markdownIt-Anchor" href="#答案"></a> 答案</h3><h4 id="java代码"><a class="markdownIt-Anchor" href="#java代码"></a> java代码</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    *  题目1：给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那两个整数，并返回他们的数组下标。</span></span><br><span class="line"><span class="comment">    *  你可以假设每种输入只会对应一个答案。但是，你不能重复利用这个数组中同样的元素</span></span><br><span class="line"><span class="comment">    *  注：此解决方法有问题，会申请大量内存，优化方向为动态hash表即官方解法。</span></span><br><span class="line"><span class="comment">    *  e.g: 给定 nums = [2, 7, 11, 15], target = 9</span></span><br><span class="line"><span class="comment">    *       因为 nums[0] + nums[1] = 2 + 7 = 9</span></span><br><span class="line"><span class="comment">    *       所以返回 [0, 1]</span></span><br><span class="line"><span class="comment">    * @param nums</span></span><br><span class="line"><span class="comment">    * @param target</span></span><br><span class="line"><span class="comment">    * @return</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[] solution01(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">       <span class="keyword">int</span> length = nums.length;</span><br><span class="line">       <span class="keyword">if</span> (length &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// 先找到nums中最小值和最大值</span></span><br><span class="line">       <span class="keyword">int</span> <span class="built_in">min</span> = nums[<span class="number">0</span>], <span class="built_in">max</span> = nums[<span class="number">0</span>];</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">           <span class="keyword">if</span> (nums[i] &gt; <span class="built_in">max</span>) &#123;</span><br><span class="line">               <span class="built_in">max</span> = nums[i];</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">if</span> (nums[i] &lt; <span class="built_in">min</span>) &#123;</span><br><span class="line">               <span class="built_in">min</span> = nums[i];</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">int</span> offset = -<span class="built_in">min</span>, tableSize = <span class="built_in">max</span> - <span class="built_in">min</span> + <span class="number">1</span>;</span><br><span class="line">       <span class="keyword">int</span>[] <span class="built_in">map</span> = <span class="keyword">new</span> <span class="keyword">int</span>[tableSize];</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tableSize; i++) &#123;</span><br><span class="line">           <span class="built_in">map</span>[i] = <span class="number">-1</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length * <span class="number">2</span>; i++) &#123;</span><br><span class="line">           <span class="keyword">if</span> (i &lt; length) &#123;</span><br><span class="line">               <span class="comment">// 在map中记录下nums的位置信息</span></span><br><span class="line">               <span class="built_in">map</span>[nums[i] + offset] = i;</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="keyword">int</span> index = target - nums[i - length] + offset;</span><br><span class="line">               <span class="keyword">if</span> (<span class="number">0</span> &lt;= index &amp;&amp; index &lt; tableSize &amp;&amp; <span class="built_in">map</span>[index] != <span class="number">-1</span> &amp;&amp; <span class="built_in">map</span>[index] != i - length) &#123;</span><br><span class="line">                   <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;i - length, <span class="built_in">map</span>[index]&#125;;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 题目1 官方解答</span></span><br><span class="line"><span class="comment">    * @param nums</span></span><br><span class="line"><span class="comment">    * @param target</span></span><br><span class="line"><span class="comment">    * @return</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[] solution02(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">       Map&lt;Integer, Integer&gt; <span class="built_in">map</span> = <span class="keyword">new</span> HashMap&lt;Integer, Integer&gt;();</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">           <span class="keyword">int</span> complement = target - nums[i];</span><br><span class="line">           <span class="keyword">if</span> (<span class="built_in">map</span>.containsKey(complement)) &#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[] &#123; <span class="built_in">map</span>.<span class="built_in">get</span>(complement), i &#125;;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="built_in">map</span>.<span class="built_in">put</span>(nums[i], i);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"No two sum solution"</span>);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h4 id="算法复杂度"><a class="markdownIt-Anchor" href="#算法复杂度"></a> 算法复杂度</h4><p>solution01算法时间复杂度为O(n)，但空间复杂度根据nums的元素决定可能会特别大，该方法不可取。<br />solution02算法时间leetCode上说是复杂度是O(n)，但我认为应该是大于O(n)，因为map.put(nums[i], i);这个操作时间复杂度可能会是log(n)，所以整体复杂度应该略大于O(n)。</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 算法 </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给定一个字符串s，请计算输出含有连续两个s作为子串的最短字符串-Java版本</title>
      <link href="/2019/02/27/%E7%BB%99%E5%AE%9A%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2s%EF%BC%8C%E8%AF%B7%E8%AE%A1%E7%AE%97%E8%BE%93%E5%87%BA%E5%90%AB%E6%9C%89%E8%BF%9E%E7%BB%AD%E4%B8%A4%E4%B8%AAs%E4%BD%9C%E4%B8%BA%E5%AD%90%E4%B8%B2%E7%9A%84%E6%9C%80%E7%9F%AD%E5%AD%97%E7%AC%A6%E4%B8%B2-Java%E7%89%88%E6%9C%AC/"/>
      <url>/2019/02/27/%E7%BB%99%E5%AE%9A%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2s%EF%BC%8C%E8%AF%B7%E8%AE%A1%E7%AE%97%E8%BE%93%E5%87%BA%E5%90%AB%E6%9C%89%E8%BF%9E%E7%BB%AD%E4%B8%A4%E4%B8%AAs%E4%BD%9C%E4%B8%BA%E5%AD%90%E4%B8%B2%E7%9A%84%E6%9C%80%E7%9F%AD%E5%AD%97%E7%AC%A6%E4%B8%B2-Java%E7%89%88%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h3 id="题目描述"><a class="markdownIt-Anchor" href="#题目描述"></a> 题目描述</h3><p>给定一个字符串s，请计算输出含有连续两个s作为子串的最短字符串</p><h3 id="思路"><a class="markdownIt-Anchor" href="#思路"></a> 思路：</h3><ol><li>从特殊到一般<br />abc -&gt; abcabc，aba -&gt; ababa，aaa -&gt; aaaa，abcdab -&gt; abcdabcdab</li><li>论证确实是寻找包含s中最后一个字符的s的子串与包含s中第一个字符的s的子串相等的最长子串。</li></ol><ul><li>显然result.length &gt; s.length</li><li>abcdab -&gt; abcdabcd   不能是 abcdabcddc非最短字符串</li></ul><ol start="3"><li>证明</li></ol><ul><li>若result[0…r]为输出的最短字符串，<br />因r &lt;= s.length时，不可能出现两个s作为子串，<br />则r &gt; s.length。</li><li>其他证明略，比较明显。</li></ul><hr /><h3 id="答案"><a class="markdownIt-Anchor" href="#答案"></a> 答案</h3><h4 id="java代码"><a class="markdownIt-Anchor" href="#java代码"></a> java代码</h4><h2 id="-0-"><a class="markdownIt-Anchor" href="#-0-"></a> <figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 题目：给定一个字符串s，请计算输出含有连续两个s作为子串的最短字符串</span></span><br><span class="line"><span class="comment">   * e.g：1. 输入abc，输出abcabc  2. 输入abcdab，输出abcdabcd，3. 输入aaa，输出aaaa</span></span><br><span class="line"><span class="comment">   * @param s</span></span><br><span class="line"><span class="comment">   * @return result</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> static <span class="built_in">char</span><span class="literal">[]</span> solution01(<span class="built_in">char</span><span class="literal">[]</span> s) &#123;</span><br><span class="line">      <span class="built_in">int</span> length = s.length;</span><br><span class="line">      <span class="comment">// 记录上一次迭代s(0...i-1)字符串头尾有相同的字符串的字符个数</span></span><br><span class="line">      <span class="built_in">int</span> dp = <span class="number">0</span>;</span><br><span class="line">      <span class="built_in">int</span> i = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span> (i &lt; length) &#123;</span><br><span class="line">          <span class="keyword">if</span> (s<span class="literal">[<span class="identifier">dp</span>]</span><span class="operator"> == </span>s<span class="literal">[<span class="identifier">i</span>]</span>) dp++;</span><br><span class="line">          <span class="keyword">else</span> dp = <span class="number">0</span>;</span><br><span class="line">          i++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (dp<span class="operator"> == </span>length - <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="comment">// s = "a" 或者 s = "aaaa"</span></span><br><span class="line">          <span class="built_in">char</span><span class="literal">[]</span> result = <span class="keyword">new</span> <span class="built_in">char</span><span class="literal">[<span class="identifier">length</span> + <span class="number">1</span>]</span>;</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>arraycopy(s, <span class="number">0</span>, result, <span class="number">0</span>, length);</span><br><span class="line">          result<span class="literal">[<span class="identifier">length</span>]</span> = s<span class="literal">[<span class="number">0</span>]</span>;</span><br><span class="line">          return result;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">char</span><span class="literal">[]</span> result = <span class="keyword">new</span> <span class="built_in">char</span><span class="literal">[<span class="number">2</span> <span class="operator">*</span> <span class="identifier">length</span> - <span class="identifier">dp</span>]</span>;</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>arraycopy(s, <span class="number">0</span>, result, <span class="number">0</span>, length);</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>arraycopy(s, dp, result, length, length - dp);</span><br><span class="line">          return result;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 只满足s中只有26个英文字母</span></span><br><span class="line"><span class="comment">   * @param s</span></span><br><span class="line"><span class="comment">   * @return</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> static <span class="built_in">char</span><span class="literal">[]</span> solution02(<span class="built_in">char</span><span class="literal">[]</span> s) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">int</span> length = s.length;</span><br><span class="line">      <span class="built_in">int</span> i = <span class="number">0</span>, j = length - <span class="number">1</span>;</span><br><span class="line">      <span class="built_in">int</span> head = <span class="number">0</span>, tail = <span class="number">0</span>, dp = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> (i &lt; length - <span class="number">1</span>) &#123;</span><br><span class="line">          head = head<span class="operator"> * </span><span class="number">26</span> + (s<span class="literal">[<span class="identifier">i</span>]</span> - <span class="character">'a'</span> + <span class="number">1</span>);</span><br><span class="line">          tail = tail + (s<span class="literal">[<span class="identifier">j</span>]</span> - <span class="character">'a'</span> + <span class="number">1</span>)<span class="operator"> * </span>(<span class="built_in">int</span>)<span class="module-access"><span class="module"><span class="identifier">Math</span>.</span></span>pow(<span class="number">26</span>, i);</span><br><span class="line">          <span class="keyword">if</span> (head<span class="operator"> == </span>tail) &#123;</span><br><span class="line">              dp = i + <span class="number">1</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          i++; j--;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (dp<span class="operator"> == </span>length - <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="comment">// s = "a" 或者 s = "aaaa"</span></span><br><span class="line">          <span class="built_in">char</span><span class="literal">[]</span> result = <span class="keyword">new</span> <span class="built_in">char</span><span class="literal">[<span class="identifier">length</span> + <span class="number">1</span>]</span>;</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>arraycopy(s, <span class="number">0</span>, result, <span class="number">0</span>, length);</span><br><span class="line">          result<span class="literal">[<span class="identifier">length</span>]</span> = s<span class="literal">[<span class="number">0</span>]</span>;</span><br><span class="line">          return result;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">char</span><span class="literal">[]</span> result = <span class="keyword">new</span> <span class="built_in">char</span><span class="literal">[<span class="number">2</span> <span class="operator">*</span> <span class="identifier">length</span> - <span class="identifier">dp</span>]</span>;</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>arraycopy(s, <span class="number">0</span>, result, <span class="number">0</span>, length);</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>arraycopy(s, dp, result, length, length - dp);</span><br><span class="line">          return result;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> static <span class="built_in">char</span><span class="literal">[]</span> solution03(<span class="built_in">char</span><span class="literal">[]</span> s) &#123;</span><br><span class="line">      return <span class="keyword">new</span> <span class="built_in">char</span><span class="literal">[<span class="number">2</span>]</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">      public static void main(String<span class="literal">[]</span> args) &#123;</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"----------solution01-------------"</span>);</span><br><span class="line">      <span class="comment">// a</span></span><br><span class="line">      <span class="built_in">char</span><span class="literal">[]</span> s1 = <span class="string">"a"</span>.<span class="keyword">to</span><span class="constructor">CharArray()</span>;</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"输入: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">s1</span>)</span></span><br><span class="line">              + <span class="string">", 输出: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">solution01</span>(<span class="params">s1</span>)</span>));</span><br><span class="line">      <span class="comment">// aaa</span></span><br><span class="line">      <span class="built_in">char</span><span class="literal">[]</span> s2 = <span class="string">"aaa"</span>.<span class="keyword">to</span><span class="constructor">CharArray()</span>;</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"输入: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">s2</span>)</span></span><br><span class="line">              + <span class="string">", 输出: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">solution01</span>(<span class="params">s2</span>)</span>));</span><br><span class="line">      <span class="comment">// abc</span></span><br><span class="line">      <span class="built_in">char</span><span class="literal">[]</span> s3 = <span class="string">"abc"</span>.<span class="keyword">to</span><span class="constructor">CharArray()</span>;</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"输入: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">s3</span>)</span></span><br><span class="line">              + <span class="string">", 输出: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">solution01</span>(<span class="params">s3</span>)</span>));</span><br><span class="line">      <span class="comment">// abcdabc</span></span><br><span class="line">      <span class="built_in">char</span><span class="literal">[]</span> s4 = <span class="string">"abcdabc"</span>.<span class="keyword">to</span><span class="constructor">CharArray()</span>;</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"输入: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">s4</span>)</span></span><br><span class="line">              + <span class="string">", 输出: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">solution01</span>(<span class="params">s4</span>)</span>));</span><br><span class="line"></span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"----------solution02-------------"</span>);</span><br><span class="line">      <span class="comment">// a</span></span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"输入: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">s1</span>)</span></span><br><span class="line">              + <span class="string">", 输出: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">solution02</span>(<span class="params">s1</span>)</span>));</span><br><span class="line">      <span class="comment">// aaa</span></span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"输入: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">s2</span>)</span></span><br><span class="line">              + <span class="string">", 输出: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">solution02</span>(<span class="params">s2</span>)</span>));</span><br><span class="line">      <span class="comment">// abc</span></span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"输入: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">s3</span>)</span></span><br><span class="line">              + <span class="string">", 输出: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">solution02</span>(<span class="params">s3</span>)</span>));</span><br><span class="line">      <span class="comment">// abcdabc</span></span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"输入: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">s4</span>)</span></span><br><span class="line">              + <span class="string">", 输出: "</span> + <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">solution02</span>(<span class="params">s4</span>)</span>));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></h2><h4 id="算法复杂度"><a class="markdownIt-Anchor" href="#算法复杂度"></a> 算法复杂度</h4><p>solution01和solution02算法复杂度都是O(n)。</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 算法 </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo学习实践:Hexo github搭建个人博客</title>
      <link href="/2019/02/01/hexo%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5/"/>
      <url>/2019/02/01/hexo%E5%AD%A6%E4%B9%A0%E5%AE%9E%E8%B7%B5/</url>
      
        <content type="html"><![CDATA[<h3 id="地址"><a class="markdownIt-Anchor" href="#地址"></a> 地址</h3><p>学习地址：<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/</a><br />博客地址：<a href="https://qiyueliuhuo.github.io/">https://qiyueliuhuo.github.io/</a></p><h3 id="配置环境"><a class="markdownIt-Anchor" href="#配置环境"></a> 配置环境</h3><ul><li>Node</li><li>Git</li><li>GitHub</li></ul><h3 id="安装hexo"><a class="markdownIt-Anchor" href="#安装hexo"></a> 安装Hexo</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo</span><br></pre></td></tr></table></figure><h3 id="初始化"><a class="markdownIt-Anchor" href="#初始化"></a> 初始化</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 在一个空文件夹，如blog中执行</span></span><br><span class="line">hexo init</span><br></pre></td></tr></table></figure><h3 id="生成静态页面"><a class="markdownIt-Anchor" href="#生成静态页面"></a> 生成静态页面</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate  (hexo g 也阔以)</span><br></pre></td></tr></table></figure><h3 id="本地启动"><a class="markdownIt-Anchor" href="#本地启动"></a> 本地启动</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br><span class="line"><span class="meta">#</span><span class="bash"> 访问http://localhost:4000/</span></span><br></pre></td></tr></table></figure><h3 id="将此博客目录与远程github仓库建立关联"><a class="markdownIt-Anchor" href="#将此博客目录与远程github仓库建立关联"></a> 将此博客目录与远程github仓库建立关联</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim _config.yml</span><br><span class="line">deploy:</span><br><span class="line">type: git</span><br><span class="line">repository: https://github.com/qiyueliuhuo/qiyueliuhuo.github.io.git</span><br><span class="line">branch: master</span><br></pre></td></tr></table></figure><h3 id="执行如下命令才能使用git部署"><a class="markdownIt-Anchor" href="#执行如下命令才能使用git部署"></a> 执行如下命令才能使用git部署</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h3 id="将deploy目录部署到github上"><a class="markdownIt-Anchor" href="#将deploy目录部署到github上"></a> 将.deploy目录部署到github上</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><h3 id="部署步骤"><a class="markdownIt-Anchor" href="#部署步骤"></a> 部署步骤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><h3 id="常用命令"><a class="markdownIt-Anchor" href="#常用命令"></a> 常用命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hexo new post "postName"  # 新建文章</span><br><span class="line">hexo new draft "draftName" # 新建草稿</span><br><span class="line">hexo new page "pageName"  # 新建页面</span><br><span class="line">hexo publish "title" # 发布title文章  Moves a draft post from _drafts to _posts folder.</span><br><span class="line">hexo generate  # 生成静态页面至public目录中</span><br><span class="line">hexo clean # 清除缓存</span><br><span class="line">hexo server  # 开启本地预览端口</span><br><span class="line">hexo deploy  # 部署到github</span><br><span class="line">hexo version # 查看hexo版本</span><br></pre></td></tr></table></figure><h3 id="编辑文章"><a class="markdownIt-Anchor" href="#编辑文章"></a> 编辑文章</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">文章头部加</span><br><span class="line">---</span><br><span class="line">title: //此处填写文章名</span><br><span class="line">date: //此处填写发布日期</span><br><span class="line">tags:</span><br><span class="line">  - //此处填写标签名(可多个)</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h3 id="文章在source_posts"><a class="markdownIt-Anchor" href="#文章在source_posts"></a> 文章在source/_posts</h3><h3 id="修改头像-友情链接等在_configyml中"><a class="markdownIt-Anchor" href="#修改头像-友情链接等在_configyml中"></a> 修改头像、友情链接等在_config.yml中</h3><h3 id="修改名字在publicindex里修改"><a class="markdownIt-Anchor" href="#修改名字在publicindex里修改"></a> 修改名字在public/index里修改</h3><h3 id="查看npm安装各hexo插件情况"><a class="markdownIt-Anchor" href="#查看npm安装各hexo插件情况"></a> 查看npm安装各Hexo插件情况</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm ls --depth 0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 缺少的插件需要安装上</span></span><br><span class="line">npm install hexo-renderer-ejs --save</span><br></pre></td></tr></table></figure><hr /><h3 id="todo-list-20200403"><a class="markdownIt-Anchor" href="#todo-list-20200403"></a> todo list    2020.04.03</h3><ul><li>[x] 评论系统  采用valine评论系统，无需后端实现。 —— 2020.07.10</li><li>[x] 访问次数，使用百度统计：<a href="http://tongji.baidu.com" target="_blank" rel="noopener">tongji.baidu.com</a>，注：百度统计接入成功后，因为数据延迟，需要等待一天才能看到百度统计上汇报的数据。 —— 2020.06.01</li><li>[x] 文章分类  —— 2019.10.01</li><li>[x] 文章目录git管理。 —— 2020.07.01<br />参考：<a href="https://www.jianshu.com/p/8814ce1da7a4" target="_blank" rel="noopener">https://www.jianshu.com/p/8814ce1da7a4</a>  <a href="https://www.imooc.com/article/9707?block_id=tuijian_wz" target="_blank" rel="noopener">https://www.imooc.com/article/9707?block_id=tuijian_wz</a></li><li>[x] 文章配图  gitee作为图床，macOS使用PicGo上传图片 —— 2020.05.29</li><li>[x] google搜索检索博客。  —— 2020.05.29<br />参考：<a href="https://liwengo.top/2019/10/11/google-search-console/" target="_blank" rel="noopener">https://liwengo.top/2019/10/11/google-search-console/</a></li></ul><hr /><h3 id="问题记录"><a class="markdownIt-Anchor" href="#问题记录"></a> 问题记录</h3><ol><li>设置 SSH 使用 hexo deploy 时<strong>免输</strong>用户名密码<br /><a href="https://segmentfault.com/a/1190000005125610" target="_blank" rel="noopener">https://segmentfault.com/a/1190000005125610</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>[JavaWeb]SSM框架整合 idea+spring+springMVC+Mybatis框架搭建教程</title>
      <link href="/2018/12/24/JavaWeb-SSM/"/>
      <url>/2018/12/24/JavaWeb-SSM/</url>
      
        <content type="html"><![CDATA[<p><strong>若图片显示有问题 请跳转此链接<a href="https://www.jianshu.com/p/68012afb5ddb" target="_blank" rel="noopener">查看全文</a> 查看</strong></p><h2 id="1-预备知识及工具"><a class="markdownIt-Anchor" href="#1-预备知识及工具"></a> 1、预备知识及工具</h2><ul><li>掌握java语言基础知识。</li><li>了解基本的MySQL相关知识。</li><li>了解http协议。</li><li>了解Jdbc技术。</li><li>了解maven项目管理工具。</li></ul><h2 id="2-开发环境"><a class="markdownIt-Anchor" href="#2-开发环境"></a> 2、开发环境</h2><ul><li>操作系统：macOS 10.13.4</li><li>IDE：IntelliJ IDEA</li><li>JDK版本：jdk1.7</li><li>Web服务器：tomcat 8.5.242</li><li>版本控制工具：git 2.15.1</li><li>项目管理工具：maven 3.5.2</li><li>数据库：mysql 14.14<br /><strong>开发环境配置可以按照上面的顺序在网上搜索相应的安装配置教程。</strong></li></ul><h2 id="3-搭建过程"><a class="markdownIt-Anchor" href="#3-搭建过程"></a> 3、搭建过程</h2><h3 id="31-框架搭建前先在mysql创建我们需要查询的数据库"><a class="markdownIt-Anchor" href="#31-框架搭建前先在mysql创建我们需要查询的数据库"></a> 3.1 框架搭建前，先在MySQL创建我们需要查询的数据库</h3><ol><li>打开数据库，并连接到数据中。<br /><img src="https://upload-images.jianshu.io/upload_images/13242528-17182d00a7cd088c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></li><li>新建一个名为demo的数据库。</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE demo DEFAULT CHARACTER SET utf8;</span><br></pre></td></tr></table></figure><ol start="3"><li>在demo数据库下，新建名为t_user数据表。</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_user (</span><br><span class="line">  <span class="keyword">id</span>    <span class="built_in">BIGINT</span>       <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="keyword">name</span>  <span class="built_in">VARCHAR</span>(<span class="number">50</span>)  <span class="keyword">COMMENT</span> <span class="string">'姓名'</span>,</span><br><span class="line">  age   <span class="built_in">INTEGER</span>      <span class="keyword">COMMENT</span> <span class="string">'年龄'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><ol start="4"><li>给t_user表中插入测试数据。<br /><img src="https://upload-images.jianshu.io/upload_images/13242528-dcc7f2b3a84946be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></li></ol><h3 id="32-使用idea新建maven项目并对项目运行环境进行配置"><a class="markdownIt-Anchor" href="#32-使用idea新建maven项目并对项目运行环境进行配置"></a> 3.2 使用idea新建maven项目，并对项目运行环境进行配置</h3><p><img src="https://upload-images.jianshu.io/upload_images/13242528-1cf0827463fe0260.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="01.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-ca09a78503cda8ea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="02.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-d1815c48f83a23cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="03.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-2a23cea9db541bab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="05.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-49b72e118d3570ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="06.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-9dac31c84d982cc0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="07.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-91dfd6808205070a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="08.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-dbb879acbc36774d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="09.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-ba1e0a6a4c07fe2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="10.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-4dbede943076bbce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="11.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-aa2ff6dd877a050b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="12.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-3b5ee67e44a2ee17.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="13.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-aca80207420da3d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="14.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-c53d1ca43bb76fb2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="15.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-7f5278598385a147.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="16.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-489b98155f3eb255.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="17.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-3bb2bf3103b3abee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="18.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-d1738f61cefcc5eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="19.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-40bc448a8d4e355a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="20.png" /></p><h3 id="33-建立maven项目的目录结构并在maven的pomxml配置文件中添加项目所需要的依赖包-注意尽量和我的pomxml保持一样避免因为版本问题出现错误"><a class="markdownIt-Anchor" href="#33-建立maven项目的目录结构并在maven的pomxml配置文件中添加项目所需要的依赖包-注意尽量和我的pomxml保持一样避免因为版本问题出现错误"></a> 3.3 建立maven项目的目录结构，并在maven的pom.xml配置文件中添加项目所需要的依赖包。（注意：尽量和我的pom.xml保持一样，避免因为版本问题，出现错误）</h3><p><img src="https://upload-images.jianshu.io/upload_images/13242528-d9e8f84582e88291.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="21.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-d9b53c7772b0c7e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="22.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-3316ef6e2cc1e6de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="23.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-4bae803e27fa1ac4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="24.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-54888901893f3251.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="25.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-a70d55976b27177b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="26.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-e0187c3c2005458f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="27.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-291c3a99041f33fc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="28.png" /></p><ul><li>完整pom.xml文件在下面文件给出，可复制。<br /><img src="https://upload-images.jianshu.io/upload_images/13242528-7f287b538fc2308f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="29.png" /></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/13242528-28439347f208cb12.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="30.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-72c01c34d4a97d4f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="31.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-f94e646310070d3c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="32.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-c47519b7b89332f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="33.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-a5b82da5e3932301.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="34.png" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-c9acde2fcb67a17e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="35.png" /></p><h3 id="34-编写demo项目类文件"><a class="markdownIt-Anchor" href="#34-编写demo项目类文件"></a> 3.4 编写demo项目类文件。</h3><h4 id="类文件分为三层"><a class="markdownIt-Anchor" href="#类文件分为三层"></a> 类文件分为三层：</h4><ul><li>dao即Data Access Object，数据访问对象。</li><li>controller，控制层，用来接收http请求。</li><li>service，业务逻辑层，用来处理与业务相关的逻辑。<br /><img src="https://upload-images.jianshu.io/upload_images/13242528-2ee5f8da23b4ef37.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="36.png" /></li><li>完整项目结构如下图。<br /><img src="https://upload-images.jianshu.io/upload_images/13242528-66a66da4039034ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="41.png" /><br /><img src="https://upload-images.jianshu.io/upload_images/13242528-c10b5187eebddba7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="UserControll.java" /></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/13242528-9a100f5eaa83fe51.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="UserDao.java" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-3ea04a7e5342abcd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="UserEntity.java" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-3165f6f6d08b074c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="UserService.java" /></p><p><img src="https://upload-images.jianshu.io/upload_images/13242528-1a3622942965c3f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="37.png" /><br /><img src="https://upload-images.jianshu.io/upload_images/13242528-c3556ddeb59d2b75.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="38.png" /></p><ul><li>配置文件及类文件如下，文件中注释对配置进行了说明。</li><li>pom.xml</li></ul><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span></span><br><span class="line"><span class="xml">  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>site.wzhe.spring<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>demo Maven Webapp<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="comment">&lt;!-- FIXME change it to the project's website --&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://www.example.com<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>4.3.16.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">mysql-connector-java.version</span>&gt;</span>5.1.17<span class="tag">&lt;/<span class="name">mysql-connector-java.version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">mybatis.version</span>&gt;</span>3.4.4<span class="tag">&lt;/<span class="name">mybatis.version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">mybatis-spring.version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">mybatis-spring.version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">c3p0.version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="name">c3p0.version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">jackson.version</span>&gt;</span>2.9.5<span class="tag">&lt;/<span class="name">jackson.version</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;spring.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;spring.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;spring.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;spring.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;spring.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;spring.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;spring.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;mysql-connector-java.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;mybatis.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;mybatis-spring.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;c3p0.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$</span><span class="template-variable">&#123;jackson.version&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">build</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>.gitignore</li></ul><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Maven #</span></span><br><span class="line">target/</span><br><span class="line"></span><br><span class="line"><span class="comment"># IDEA #</span></span><br><span class="line"><span class="string">.idea/</span></span><br><span class="line">*<span class="string">.iml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Eclipse #</span></span><br><span class="line"><span class="string">.settings/</span></span><br><span class="line"><span class="string">.metadata/</span></span><br><span class="line"><span class="string">.classpath</span></span><br><span class="line"><span class="string">.project</span></span><br><span class="line">Servers/</span><br></pre></td></tr></table></figure><ul><li>web.xml文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">"3.1"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 加载Spring容器配置 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Spring容器加载所有bean的配置文件的路径 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath*:spring/applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 配置SpringMVC核心控制器,将所有的请求(除了刚刚Spring MVC中的静态资源请求)都交给Spring MVC --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- DispatcherServlet上下文在初始化的时候会建立自己的IoC上下文，用以持有spring mvc相关的bean。 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath*:spring/applicationContext-mvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--用来标记是否在项目启动时就加在此Servlet,0或正数表示容器在应用启动时就加载这个Servlet,</span></span><br><span class="line"><span class="comment">    当是一个负数时或者没有指定时，则指示容器在该servlet被选择时才加载.正数值越小启动优先值越高  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--为DispatcherServlet建立映射--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 拦截所有请求,千万注意是(/)而不是(/*) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 设置编码过滤器 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>jdbc.properties文件</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc.driverClassName</span>=com.mysql.jdbc.Driver</span><br><span class="line"><span class="attr">jdbc.url</span>=jdbc:mysql://localhost:<span class="number">3306</span>/demo?characterEncoding=UTF-<span class="number">8</span></span><br><span class="line"><span class="attr">jdbc.username</span>=root</span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jdbc.initialPoolSize</span>=<span class="number">20</span></span><br><span class="line"><span class="attr">jdbc.maxPoolSize</span>=<span class="number">100</span></span><br><span class="line"><span class="attr">jdbc.minPoolSize</span>=<span class="number">10</span></span><br><span class="line"><span class="attr">jdbc.maxIdleTime</span>=<span class="number">600</span></span><br><span class="line"><span class="attr">jdbc.acquireIncrement</span>=<span class="number">5</span></span><br><span class="line"><span class="attr">jdbc.maxStatements</span>=<span class="number">50</span></span><br><span class="line"><span class="attr">jdbc.idleConnectionTestPeriod</span>=<span class="number">60</span></span><br></pre></td></tr></table></figure><ul><li>UserDaoMapper.xml文件</li></ul><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"site.wzhe.spring.demo.dao.UserDao"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getById"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.Long"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        SELECT id, username, age</span></span><br><span class="line"><span class="xml">        FROM t_user</span></span><br><span class="line"><span class="xml">        WHERE id = #</span><span class="template-variable">&#123;id, jdbcType=BIGINT&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>mybatis-config.xml文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD SQL Map Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--实体类匹配成XXXMapper.xml中可以直接使用的类型，相当于一个别名，在XXXMapper.xml中就无需再写完整的实体类全路径，直接用alias的值来代替--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"site.wzhe.spring.demo.entity.UserEntity"</span> <span class="attr">alias</span>=<span class="string">"User"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>applicationContext.xml文件</li></ul><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span></span><br><span class="line"><span class="xml">       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tx="http://www.springframework.org/schema/tx"</span></span><br><span class="line"><span class="xml">       xmlns:context="http://www.springframework.org/schema/context"</span></span><br><span class="line"><span class="xml">       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- ===============spring容器(父容器)的配置文件 ================== --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"site.wzhe.spring.demo.service"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 加载jdbc.properties配置文件 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc/jdbc.properties"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--数据源-链接数据库的基本信息--&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;jdbc.driverClassName&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;jdbc.url&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;jdbc.username&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;jdbc.password&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!--mybatis的配置文件--&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis/mybatis-config.xml"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!--扫描 XXXDaoMapper.xml映射文件,配置扫描的路径--&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:mappers/*.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- DAO接口所在包名，Spring会自动查找之中的类 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"site.wzhe.spring.demo.dao"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"sqlSessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--事务管理--&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span></span></span></span><br><span class="line"><span class="xml">          class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt;</span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!--注入dataSource--&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--开启事务注解扫描--&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span><span class="tag">&lt;/<span class="name">tx:annotation-driven</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>applicationContext-mvc.xml文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span> <span class="attr">xmlns:p</span>=<span class="string">"http://www.springframework.org/schema/p"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:util</span>=<span class="string">"http://www.springframework.org/schema/util"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ===============spring web容器(子容器)的配置文件 ================== --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- org.springframework.web.servlet.resource.DefaultServletHttpRequestHandler，</span></span><br><span class="line"><span class="comment">    它会像一个检查员，对进入DispatcherServlet的URL进行筛查，如果发现是静态资源的请求，</span></span><br><span class="line"><span class="comment">    就将该请求转由Web应用服务器默认的Servlet处理，如果不是静态资源的请求，才由DispatcherServlet继续处理。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 告知Spring，会自动注册DefaultAnnotationHandlerMapping与AnnotationMethodHandlerAdapter 两个bean,是spring MVC为@Controllers分发请求所必须的。--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--SpringMVC相关如下配置，经过验证，这个是SpringMVC必须要配置的，因为它声明了@RequestMapping、@RequestBody、@ResponseBody等。并且，该配置默认加载很多的参数绑定方法，比如json转换解析器等。--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- json请求无法通过@RequestBody转为对象，添加这个就可以解决--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.ResourceHttpMessageConverter"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 指定要扫描的包的位置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"site.wzhe.spring.demo.controller"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 对静态资源文件的访问,因为Spring MVC会拦截所有请求,导致jsp页面中对js和CSS的引用也被拦截,配置后可以把对资源的请求交给项目的默认servlet而不是Spring MVC--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">"/static/**"</span> <span class="attr">location</span>=<span class="string">"/WEB-INF/static/"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 为RequestMappingHandlerAdapter装配可处理JSON格式的请求/响应消息的HttpMessage Converter--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter"</span> <span class="attr">p:messageConverters-ref</span>=<span class="string">"messageConverters"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">util:list</span> <span class="attr">id</span>=<span class="string">"messageConverters"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.BufferedImageHttpMessageConverter"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.ByteArrayHttpMessageConverter"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.support.AllEncompassingFormHttpMessageConverter"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">util:list</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置Spring MVC的视图解析器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 有时我们需要访问JSP页面,可理解为在控制器controller的返回值加前缀和后缀,变成一个可用的URL地址 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>UserController.java 文件</li></ul><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package site.wzhe.spring.demo.controller;</span><br><span class="line"></span><br><span class="line">import org.springframework.beans.factory.<span class="keyword">annotation</span>.<span class="title">Autowired</span>;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">PathVariable</span>;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">RequestMapping</span>;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">RequestMethod</span>;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">ResponseBody</span>;</span><br><span class="line">import site.wzhe.spring.demo.entity.UserEntity;</span><br><span class="line">import site.wzhe.spring.demo.service.UserService;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @<span class="symbol">author:</span> andup.</span><br><span class="line"> * @<span class="symbol">description:</span></span><br><span class="line"> * @<span class="symbol">date:</span> <span class="number">2018</span>/<span class="number">7</span>/<span class="number">21</span>.</span><br><span class="line"> *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">@Controller</span></span><br><span class="line"><span class="regexp">public class UserController &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    @Autowired</span></span><br><span class="line"><span class="regexp">    private UserService userService;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    @RequestMapping(value = "/api</span><span class="regexp">/user/</span>&#123;id&#125;<span class="string">", method = RequestMethod.GET)</span></span><br><span class="line"><span class="string">    @ResponseBody</span></span><br><span class="line"><span class="string">    UserEntity getById(@PathVariable Long id) &#123;</span></span><br><span class="line"><span class="string">        return userService.getById(id);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><ul><li>UserDao.java文件</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> site.wzhe.spring.demo.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> site.wzhe.spring.demo.entity.UserEntity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: andup.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2018/7/21.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function">UserEntity <span class="title">getById</span><span class="params">(Long id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>UserEntity.java文件</li></ul><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package site.wzhe.spring.demo.entity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @author: andup.</span></span><br><span class="line"><span class="comment"> * @description:</span></span><br><span class="line"><span class="comment"> * @date: 2018/7/21.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserEntity</span> &#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getUserName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserName</span><span class="params">(<span class="keyword">String</span> userName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userName = userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>UserService.java文件</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> site.wzhe.spring.demo.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.<span class="keyword">annotation</span>.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> site.wzhe.spring.demo.dao.UserDao;</span><br><span class="line"><span class="keyword">import</span> site.wzhe.spring.demo.entity.UserEntity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: andup.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2018/7/21.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UserEntity getById(<span class="built_in">Long</span> id) &#123;</span><br><span class="line">        <span class="keyword">return</span> userDao.getById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>后面四个类文件对应项目中类位置如下。<br /><img src="https://upload-images.jianshu.io/upload_images/13242528-699d9d00dbfc2f59.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="39.png" /></li></ul><h3 id="35-通过游览器输入地址测试项目是否运行成功"><a class="markdownIt-Anchor" href="#35-通过游览器输入地址测试项目是否运行成功"></a> 3.5 通过游览器输入地址，测试项目是否运行成功。</h3><ul><li>在游览器地址栏输入：localhost:8080/api/user/1<br /><img src="https://upload-images.jianshu.io/upload_images/13242528-44dba67df9bc96ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="40.png" /></li><li>后端返回数据。目前大多数项目都是前后端分离项目，后端返回数据，前端进行渲染，展示给用户。所以，游览器从后端返回Json格式的数据即可。</li></ul><p><strong>如果对你有帮助，可以关注我，后续有更多详细教程。</strong></p><h5 id="原创文章请勿用于商业用途转载请著名出处"><a class="markdownIt-Anchor" href="#原创文章请勿用于商业用途转载请著名出处"></a> 原创文章,请勿用于商业用途,转载请著名出处。</h5><p>up</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> javaWeb </tag>
            
            <tag> 后端 </tag>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Double Checked locking 模式存在的问题</title>
      <link href="/2018/12/09/Double-Checked-locking-%E6%A8%A1%E5%BC%8F%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2018/12/09/Double-Checked-locking-%E6%A8%A1%E5%BC%8F%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h3 id="问题"><a class="markdownIt-Anchor" href="#问题"></a> 问题</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> SettingsDbHelper sInst = <span class="keyword">null</span>;  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SettingsDbHelper <span class="title">getInstance</span><span class="params">(Context context)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (sInst == <span class="keyword">null</span>) &#123;                              <span class="comment">// 1</span></span><br><span class="line">        <span class="keyword">synchronized</span> (SettingsDbHelper<span class="class">.<span class="keyword">class</span>) </span>&#123;       <span class="comment">// 2</span></span><br><span class="line">            SettingsDbHelper inst = sInst;            <span class="comment">// 3</span></span><br><span class="line">            <span class="keyword">if</span> (inst == <span class="keyword">null</span>) &#123;                       <span class="comment">// 4</span></span><br><span class="line">                inst = <span class="keyword">new</span> SettingsDbHelper(context); <span class="comment">// 5</span></span><br><span class="line">                sInst = inst;                         <span class="comment">// 6</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sInst;                                     <span class="comment">// 7</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Double Checked locking 模式，保证多线程安全，Coverity 是静态代码分析工具，它会模拟其实际运行情况。<br />原因：new SettingsDbHelper(context)并不是一个原子操作，编译后可能会因为与下面的语句发生指令重排，<br />既是没有下面sInst = inst，也会因为先给sInst初始化，而构造函数并没有执行完，这样在另一个线程中，调用<br />该函数时，确实返回了初始化的sInst(不为null)，但因为构造函数没有执行完，仍然会出现线程问题。</p><h3 id="解决方法一"><a class="markdownIt-Anchor" href="#解决方法一"></a> 解决方法一</h3><p>在 Java 5 之后，引入扩展关键字 volatile 的功能，它能保证：对 volatile 变量的写操作，不允许和它之前的读写操作打乱顺序；对 volatile 变量的读操作，不允许和它之后的读写乱序。所以，上面的操作，只需要对 sInst 变量添加 volatile 关键字修饰即可。<br />即</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> SettingsDbHelper sInst = <span class="keyword">null</span>;  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SettingsDbHelper <span class="title">getInstance</span><span class="params">(Context context)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (sInst == <span class="keyword">null</span>) &#123;                              <span class="comment">// 1</span></span><br><span class="line">        <span class="keyword">synchronized</span> (SettingsDbHelper<span class="class">.<span class="keyword">class</span>) </span>&#123;       <span class="comment">// 2</span></span><br><span class="line">            SettingsDbHelper inst = sInst;            <span class="comment">// 3</span></span><br><span class="line">            <span class="keyword">if</span> (inst == <span class="keyword">null</span>) &#123;                       <span class="comment">// 4</span></span><br><span class="line">                inst = <span class="keyword">new</span> SettingsDbHelper(context); <span class="comment">// 5</span></span><br><span class="line">                sInst = inst;                         <span class="comment">// 6</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sInst;                                     <span class="comment">// 7</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="解决方法二"><a class="markdownIt-Anchor" href="#解决方法二"></a> 解决方法二</h3><p>对 volatile 变量的读写操作是一个比较重的操作，所以上面的代码还可以优化一下，如下:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> SettingsDbHelper sInst = <span class="keyword">null</span>;  <span class="comment">// &lt;&lt;&lt; 这里添加了 volatile  </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SettingsDbHelper <span class="title">getInstance</span><span class="params">(Context context)</span> </span>&#123;  </span><br><span class="line">    SettingsDbHelper inst = sInst;  <span class="comment">// &lt;&lt;&lt; 在这里创建临时变量</span></span><br><span class="line">    <span class="keyword">if</span> (inst == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (SettingsDbHelper<span class="class">.<span class="keyword">class</span>) </span>&#123;</span><br><span class="line">            inst = sInst;</span><br><span class="line">            <span class="keyword">if</span> (inst == <span class="keyword">null</span>) &#123;</span><br><span class="line">                inst = <span class="keyword">new</span> SettingsDbHelper(context);</span><br><span class="line">                sInst = inst;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> inst;  <span class="comment">// &lt;&lt;&lt; 注意这里返回的是临时变量</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>mac系统快捷键</title>
      <link href="/2018/10/04/mac%E7%B3%BB%E7%BB%9F%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
      <url>/2018/10/04/mac%E7%B3%BB%E7%BB%9F%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
      
        <content type="html"><![CDATA[<h4 id="按键"><a class="markdownIt-Anchor" href="#按键"></a> 按键</h4><ul><li>⌘ == Command</li><li>⇧ == Shift</li><li>⇪ == Caps Lock</li><li>⌥ == Option/Alt</li><li>⌃ == Control</li><li>⌫ == Delete(win上back space)</li><li>⏏ == 电源开关键</li></ul><p>辅助软件：CheatSheet 长按Command键提示当前应用的快捷键</p><h4 id="系统"><a class="markdownIt-Anchor" href="#系统"></a> 系统</h4><ul><li>Command + 空格键 : 切换输入法</li></ul><h4 id="常用"><a class="markdownIt-Anchor" href="#常用"></a> 常用</h4><ul><li>Command + X : <strong>剪切</strong>所选项并拷贝到剪切板。</li><li>Command + C : <strong>拷贝</strong>到剪切板，适用于访达中的文件。</li><li>Command + V : 将剪切板中的内容<strong>粘贴</strong>到文稿或访达中。</li><li>Command + Z : <strong>撤销</strong>前一个命令。</li><li>Command + Shift + Z : <strong>反撤销</strong>前一个撤销。</li><li>Command + A : <strong>全选</strong>各项。</li><li>Command + F : <strong>查找</strong>文稿中内容或者打开“查找”窗口。</li><li>Command + O : <strong>打开</strong>所选项，或打开一个对话框以选择要打开的文件。</li><li>Command + N : <strong>新建</strong>文稿或窗口。</li><li>Command + I : 显示选中文件的<strong>简介</strong>。</li><li>Command + S : <strong>存储</strong>当前文稿。</li><li>Command + Shift + S : <strong>另存为</strong>。</li><li>Command + W : <strong>关闭</strong>。</li><li>Command + Q : <strong>退出</strong>应用。</li><li>Command + Control + F : <strong>应用全屏</strong>。</li><li>Command + Tab : <strong>切换应用</strong>，在打开的应用中切换到下一个最近使用的应用。</li><li>Command + Shift + Tab : 在<strong>应用程序</strong>间反向切换。</li><li>Command + 逗号（，）: 打开最前面的应用的<strong>偏好设置</strong>。</li><li>Control + 左键/右键 ： <strong>切换桌</strong>面。</li><li>Command + + : <strong>放大</strong>。</li><li>Command + - : <strong>缩小</strong>。</li></ul><h4 id="移动"><a class="markdownIt-Anchor" href="#移动"></a> 移动</h4><ul><li>Command + 左键 : 移动到行首。</li><li>Command + 右键 : 移动到行尾。</li><li>Option + 左键 : 向左移动一个单词。</li><li>Option + 右键 : 向右移动一个单词。</li></ul><h4 id="截屏-基于qq应用qq退出后截图录屏保持运行"><a class="markdownIt-Anchor" href="#截屏-基于qq应用qq退出后截图录屏保持运行"></a> 截屏 基于qq应用（qq退出后，截图录屏保持运行）</h4><ul><li>Command + Control + A : 截屏。</li><li>Command + Control + R : 录屏。</li></ul><h4 id="截屏-系统自带"><a class="markdownIt-Anchor" href="#截屏-系统自带"></a> 截屏 系统自带</h4><ul><li>Command + Shift + 3 : 截取全屏</li><li>Command + Shift + 4 : 截取任意窗口</li><li>Command + Shift + 4，之后再按空格键 : 截图窗口</li><li>$: defaults write com.apple.screencapture location ~/Desktop/截图图库 ： 设置默认截屏保存路径</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>docker学习</title>
      <link href="/2018/10/04/docker%E5%AD%A6%E4%B9%A0/"/>
      <url>/2018/10/04/docker%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h3 id="参考地址"><a class="markdownIt-Anchor" href="#参考地址"></a> 参考地址</h3><ul><li><a href="http://www.docker.org.cn/book/docker/docker-getting-started-14.html" target="_blank" rel="noopener">http://www.docker.org.cn/book/docker/docker-getting-started-14.html</a></li><li><a href="http://guide.daocloud.io/dcs/3-9152643.html" target="_blank" rel="noopener">http://guide.daocloud.io/dcs/3-9152643.html</a></li><li><a href="https://cloud.docker.com/repository/list" target="_blank" rel="noopener">https://cloud.docker.com/repository/list</a></li></ul><h3 id="指令"><a class="markdownIt-Anchor" href="#指令"></a> 指令</h3><ul><li>docker pull tomcat  # 拉取tomcat镜像</li><li>sudo service docker start  # 启动docker daemon</li><li>docker search tutorial  #搜索镜像</li><li>docker run learn/tutorial echo “hello word”  # 在容器中运行echo命令</li><li>docker run learn/tutorial apt-get install -y ping  #在镜像容器learn/tutorial中安装ping命令</li><li>docker ps -l # 获得安装完ping命令之后容器的id。</li><li>docker ps -a # 查看所有的容器</li><li>docker commit 8c6 learn/ping  #保存对容器的修改，会返回新版本镜像的id号</li><li>docker search tomcat</li><li>docker images 查看本地镜像</li><li>docker run -i -t -d -v ~/download:/home/hello python3-env /bin/bash</li><li>docker rm Name/ID # 删除单个容器</li><li>docker rmi Name/ID # 删除镜像</li><li>docker attach 8704a9700502  # 进入一个正在运行的docker容器</li><li>docker run -d  # 后台模式运行</li><li>Control + Q + P  # 在docker中退出后容器在后台运行</li><li>docker start b750bbbcfd88  # 启动已停止运行的容器</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>数据库之索引</title>
      <link href="/2018/07/11/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B9%8B%E7%B4%A2%E5%BC%95/"/>
      <url>/2018/07/11/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B9%8B%E7%B4%A2%E5%BC%95/</url>
      
        <content type="html"><![CDATA[<h2 id="概念-要点"><a class="markdownIt-Anchor" href="#概念-要点"></a> 概念、要点</h2><h3 id="概念"><a class="markdownIt-Anchor" href="#概念"></a> 概念：</h3><ul><li>索引（在MySQL中也叫键）是存储引擎用于快速找到记录的一种数据结构。</li></ul><h3 id="索引的类型"><a class="markdownIt-Anchor" href="#索引的类型"></a> 索引的类型</h3><h5 id="不同的存储引擎的索引的工作方式并不一样也不是所有的存储引擎都支持所有类型的索引即使类型一样底层实现也可能不同"><a class="markdownIt-Anchor" href="#不同的存储引擎的索引的工作方式并不一样也不是所有的存储引擎都支持所有类型的索引即使类型一样底层实现也可能不同"></a> 不同的存储引擎的索引的工作方式并不一样，也不是所有的存储引擎都支持所有类型的索引，即使类型一样，底层实现也可能不同。</h5><ul><li>B-Tree索引</li><li>哈希索引</li><li>空间数据索引（R-Tree)</li><li>全文索引</li><li>其他类型索引</li></ul><h3 id="要点"><a class="markdownIt-Anchor" href="#要点"></a> 要点</h3><ul><li>表中数据量非常大时，索引对性能的影响非常重要。</li><li>索引应该是对查询性能优化最有效的手段了。</li><li>索引可以包含一个或多个列的值。如果索引包含多个列，那么列的顺序十分重要，因为MySQL<strong>只能</strong>高效地使用索引的<strong>最左前缀列</strong>。</li></ul><h3 id="索引的原理"><a class="markdownIt-Anchor" href="#索引的原理"></a> 索引的原理</h3><h4 id="1-b-tree索引"><a class="markdownIt-Anchor" href="#1-b-tree索引"></a> 1. B-Tree索引</h4><p>若没说索引类型，一般指的是B-Tree索引，使用B-Tree数据结构来存储数据，意味着所有的值都是按顺序存储的（很适合查找范围数据），并且每一个叶子页到根的距离相同。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 若有如下数据表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> People &#123;</span><br><span class="line">    last_name  <span class="built_in">varchar</span>(<span class="number">50</span>)     <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    first_name <span class="built_in">varchar</span>(<span class="number">50</span>)     <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    dob        <span class="built_in">date</span>            <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    gender     enum(<span class="string">'m'</span>, <span class="string">'f'</span>)  <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    <span class="keyword">key</span>(last_name, first_name, dob)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>索引对多个值进行排序的依据是create table语句中定义索引时列的顺序。</li><li>MySQL适用的查找类型为 <strong>全值匹配</strong>、<strong>匹配最左前缀</strong>、<strong>匹配列前缀</strong>、<strong>匹配范围值</strong>、<strong>精确匹配某一列并范围匹配另外一列</strong>、<strong>只访问索引的查询</strong>。</li></ul><h4 id="2-哈希索引"><a class="markdownIt-Anchor" href="#2-哈希索引"></a> 2. 哈希索引</h4><p>哈希索引（hash index）基于哈希表实现，只有<strong>精确匹配</strong>索引所有列的查询才有效。哈希索引将所有的哈希码存储在索引中，同时在哈希表中保存指向每个数据行的指针。</p><ul><li>只有Memory引擎<strong>显式</strong>支持哈希索引。</li></ul><h4 id="3-空间数据索引"><a class="markdownIt-Anchor" href="#3-空间数据索引"></a> 3. 空间数据索引</h4><p>空间索引会从所有维度来索引数据。MySQL的GIS支持并不完善，所以大部分人都不会使用这个特性。</p><h4 id="4-全文索引"><a class="markdownIt-Anchor" href="#4-全文索引"></a> 4. 全文索引</h4><h3 id="索引的应用"><a class="markdownIt-Anchor" href="#索引的应用"></a> 索引的应用</h3><h4 id="1-b-tree索引-2"><a class="markdownIt-Anchor" href="#1-b-tree索引-2"></a> 1. B-Tree索引</h4><ul><li>创建数据库并建立如下数据表<br /><img src="https://note.youdao.com/yws/api/personal/file/WEB922cbab210055a33e4d0a75dc5e91b42?method=download&amp;shareKey=8a5c080d8328af950e3675bbe70a9661" alt="image" /></li><li>给表中插入数据<br /><img src="https://note.youdao.com/yws/api/personal/file/WEB703e816606fc6e8c94234b98c08ae3fb?method=download&amp;shareKey=20761849af4525d32683b5c91da77443" alt="image" /></li></ul><h5 id="使用索引的几种情况"><a class="markdownIt-Anchor" href="#使用索引的几种情况"></a> 使用索引的几种情况</h5><h5 id="1-全值匹配"><a class="markdownIt-Anchor" href="#1-全值匹配"></a> 1. 全值匹配</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> high_performance_mysql.People <span class="keyword">WHERE</span> last_name = <span class="string">"Allen"</span> <span class="keyword">AND</span> first_name = <span class="string">"Cuba"</span> <span class="keyword">AND</span> dob = <span class="string">"1960-01-01"</span>;</span><br></pre></td></tr></table></figure><p><img src="https://note.youdao.com/yws/api/personal/file/WEBe698c99c31388695771f6287f45ece4f?method=download&amp;shareKey=6f4ce5e1ebb158187c223f41bcc2c115" alt="image" /></p><h5 id="2-匹配最左前缀"><a class="markdownIt-Anchor" href="#2-匹配最左前缀"></a> 2. 匹配最左前缀</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> high_performance_mysql.People <span class="keyword">WHERE</span> last_name = <span class="string">"Allen"</span>;</span><br></pre></td></tr></table></figure><p><img src="https://note.youdao.com/yws/api/personal/file/WEB89813d2d5dfcefb62ed6646f8134e933?method=download&amp;shareKey=508947b940032039f148bf9fc22175ef" alt="image" /></p><h5 id="3-匹配列前缀"><a class="markdownIt-Anchor" href="#3-匹配列前缀"></a> 3. 匹配列前缀</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> high_performance_mysql.People <span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">'J%'</span>;</span><br></pre></td></tr></table></figure><p>有问题 TODO</p><h5 id="4-匹配范围值"><a class="markdownIt-Anchor" href="#4-匹配范围值"></a> 4. 匹配范围值</h5><h5 id="5-精确匹配某一列并范围匹配另外一列"><a class="markdownIt-Anchor" href="#5-精确匹配某一列并范围匹配另外一列"></a> 5. 精确匹配某一列并范围匹配另外一列</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> high_performance_mysql.People <span class="keyword">WHERE</span> last_name = <span class="string">"Allen"</span> <span class="keyword">AND</span> first_name <span class="keyword">LIKE</span> <span class="string">"K%"</span>;</span><br></pre></td></tr></table></figure><p><img src="https://note.youdao.com/yws/api/personal/file/WEB65154b6e2bd0f3c5f79e0138b3007863?method=download&amp;shareKey=76b5576a55d1b26d2e2a9b476fcf6303" alt="image" /></p><h5 id="b-tree索引的限制"><a class="markdownIt-Anchor" href="#b-tree索引的限制"></a> B-Tree索引的限制</h5><h6 id="根据索引的底层原理使用就很容易想通为什么有这些限制了"><a class="markdownIt-Anchor" href="#根据索引的底层原理使用就很容易想通为什么有这些限制了"></a> 根据索引的底层原理使用，就很容易想通为什么有这些限制了。</h6><ul><li>如果不是按照索引的最左前列开始查找，则无法使用索引。</li><li>不能跳过索引中的列。如果跳过，则只是用索引的第一列。</li><li>如果查询中有某个列的范围查询，则其右边所有列都无法使用索引优化查找。</li></ul><h3 id="问题记录"><a class="markdownIt-Anchor" href="#问题记录"></a> 问题记录</h3><ol><li>like ‘A%’  和 like ‘J%’<br />EXPLAIN SELECT * FROM high_performance_mysql.People WHERE last_name LIKE ‘A%’ 当数据库中A%数据占数据表很大部分时，走索引和不走索引效率区别不大，索引没有走索引。<br />一种情况使用到索引，一种情况没有使用到索引，猜测是否用索引可能和结果集大小也有关，mysql内部做优化。<br />在表数据量足够大情况下，才走索引。</li><li>底层实现原理弄懂，才能真正明白一些应用和限制的原因。</li><li>SQL 查询性能分析  <a href="https://blog.csdn.net/moqiang02/article/details/42433525" target="_blank" rel="noopener">https://blog.csdn.net/moqiang02/article/details/42433525</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>LNMP分布式集群搭建</title>
      <link href="/2018/06/16/LNMP%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/"/>
      <url>/2018/06/16/LNMP%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p><img src="https://note.youdao.com/yws/api/personal/file/WEB1c22ac7bb353014a01f3f91485cfaaa0?method=download&amp;shareKey=0f4ff9f8bdb82aaf871dc682b3fe8110" alt="image" /><br />       一共需要9台服务器，程序部分由一台负载均衡和两台Nginx+PHP服务器组成，数据库部分由两台MySql服务器组成，文件存储部分由两台Nginx（其中一台是Nginx+PHP）和一台NFS服务器组成。还有一台Memcached服务器作为数据缓存，用于处理读写频繁的热门数据。</p><table><thead><tr><th>编号</th><th>服务器</th><th>硬件侧重点</th></tr></thead><tbody><tr><td>1</td><td>Nginx（www.itshop.test）</td><td>网卡性能</td></tr><tr><td>2</td><td>Nginx（file.itshop.test)</td><td>内存容量、磁盘性能</td></tr><tr><td>3</td><td>Nginx + PHP（upload.itshop.test）</td><td>网卡性能</td></tr><tr><td>4</td><td>Nginx + PHP</td><td>CPU性能</td></tr><tr><td>5</td><td>Nginx + PHP</td><td>CPU性能</td></tr><tr><td>6</td><td>NFS</td><td>磁盘容量</td></tr><tr><td>7</td><td>MySQL（主）</td><td>CPU、内存、磁盘整体性能</td></tr><tr><td>8</td><td>MySQL（从）</td><td>CPU、内存、磁盘整体性能</td></tr><tr><td>9</td><td>Memcached</td><td>内存容量</td></tr></tbody></table><ol><li>部署Linux服务器</li></ol><ul><li>选择CentOS 7 系统最小化部署在vmware fusion虚拟机上。（root 19960621）（andy 19960621）</li><li>使用命令：ip addr查看网络信息。</li><li>使用命令：vi /etc/sysconfig/network-scripts/ifcfg-ens33修改网卡配置，修改或增加以下几项。</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ONBOOT</span>=<span class="string">"yes"</span>                 <span class="attribute">BOOTPROTO</span>=<span class="string">"static"</span>              <span class="attribute">IPADDR</span>=<span class="string">"172.16.212.11"</span></span><br><span class="line"><span class="attribute">NETMASK</span>=<span class="string">"255.255.255.0"</span>      <span class="attribute">GATEWAY</span>=<span class="string">"172.16.212.1"</span>          <span class="attribute">DNS1</span>=<span class="string">"172.16.212.1"</span></span><br></pre></td></tr></table></figure><ul><li>确保在CentOS中可以ping通主机中的虚拟接口vmnet8地址。</li><li>编写脚本来改变各个克隆系统的地址。</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">文件名：netconfig.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">ens33=<span class="regexp">/etc/</span>sysconfig<span class="regexp">/network-scripts/i</span>fcfg-ens33</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"$1"</span> = <span class="string">""</span> ]; then <span class="keyword">exit</span> <span class="number">3</span>; fi</span><br><span class="line">sed -i <span class="string">'s/IPADDR=.*/IPADDR=172.16.212.1'</span><span class="variable">$1</span><span class="string">'/'</span> <span class="variable">$ens33</span></span><br><span class="line">sed -i <span class="string">'s/UUID=.*/UUID='</span>`uuidgen`<span class="string">'/g'</span> <span class="variable">$ens33</span></span><br></pre></td></tr></table></figure><ul><li>根据下图先从1号系统克隆出6、7和9号系统CentOS系统。<br /><img src="https://note.youdao.com/yws/api/personal/file/WEBd98e0ba8a718e76ce6e2f00d5d8eef70?method=download&amp;shareKey=60524d2f00b213d64115f8b882c1877d" alt="image" /></li><li>克隆后，运行脚本./netconfig.sh 6 改变系统ip地址。</li><li>启动sshd服务，方便主机通过ssh连接系统，命令：service sshd start。</li></ul><ol start="2"><li>安装Nginx</li></ol><ul><li>更新下yum源。</li><li>安装依赖包</li></ul><figure class="highlight plain"><figcaption><span>-y install gcc pcre-devel openssl-devel ```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- 下载安装包。</span><br><span class="line">&#96;&#96;&#96; wget http:&#x2F;&#x2F;nginx.org&#x2F;download&#x2F;nginx-1.14.0.tar.gz</span><br></pre></td></tr></table></figure><ul><li>解压文件。</li></ul><figure class="highlight plain"><figcaption><span>zxvf nginx-1.14.0```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- 编译安装，并增加http\_realip_module模块。</span><br><span class="line">&#96;&#96;&#96; .&#x2F;configure --with-http_ssl_module --with-http_realip_module &amp;&amp; make &amp;&amp; make install</span><br></pre></td></tr></table></figure><ul><li>创建软链接到/usr/local/sbin目录中，该目录在PATH变量中，所以直接创建软链接之后，就可以直接使用nginx命令。</li></ul><figure class="highlight ls"><figcaption><span>-s</span><a href="/usr/local/nginx/sbin/nginx">/usr/local/sbin/nginx ```</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 在CentOS中，service命令实际上是调用了<span class="regexp">/etc/init.d目录下的shell脚本。所以编写nginx的shell脚本，将脚本放在/etc/init.d/</span>目录下。</span><br></pre></td></tr></table></figure><pre><code>#! /bin/bashDAEMON=/usr/local/nginx/sbin/nginxcase &quot;$1&quot; in    start)        echo &quot;Starting nginx daemon...&quot;        $DAEMON &amp;&amp; echo &quot;SUCCESS&quot;    ;;    stop)        echo &quot;Stopping nginx daemon...&quot;        $DAEMON -s quit &amp;&amp; echo &quot;SUCCESS&quot;    ;;    reload)        echo &quot;Reloading nginx daemon...&quot;        $DAEMON -s reload &amp;&amp; echo &quot;SUCCESS&quot;    ;;    restart)        echo &quot;Restarting nginx daemon...&quot;        $DAEMON -s quit        $DAEMON &amp;&amp; echo &quot;SUCCESS&quot;    ;;    *)        echo &quot;Usage: service nginx (start|stop|restart|reload)&quot;        exit 2    ;;esac</code></pre><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 设置开机启动：chkconfig --<span class="keyword">add</span><span class="bash"> nginx</span></span><br></pre></td></tr></table></figure><pre><code>报错：error reading information on service nginx: Invalid argument目前不知道如何解决。</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>配置并启动Nginx。</span><br></pre></td></tr></table></figure><pre><code># useradd -s /sbin/nologin -M www# mkdir -p /data/www# cp ../html/* /data/www# chown -R www:www /data/www# vi ../conf/nginx.conf改动部分如下：# configure useruser  www www;worker_processes  1;# modify server block:    server {        listen       80;        server_name  localhost;root /data/www;index index.html index.htm;        #charset koi8-r;        #access_log  logs/host.access.log  main;        #location / {        #    root   html;        #    index  index.html index.htm;        #}        #error_page  404              /404.html;        # redirect server error pages to the static page /50x.html        #        #error_page   500 502 503 504  /50x.html;        #location = /50x.html {        #    root   html;        #}# firewall-cmd --zone=public --add-port=80/tcp --permanent # 开放80端口。</code></pre><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>查看nginx是否启动：ps -aux |grep nginx</span><br><span class="line"><span class="bullet">- </span>查看nginx监听端口：netstat -an | grep 80</span><br><span class="line"><span class="bullet">- </span>CentOS中，无netstat和ifconfig命令，需安装：yum install net-tools。</span><br><span class="line"><span class="bullet">- </span>在游览器中访问地址，成功打开nginx欢迎页面。</span><br><span class="line">![<span class="string">image</span>](<span class="link">https://note.youdao.com/yws/api/personal/file/WEB5c5cb87d060b173a95b4d4ff6b28ad66?method=download&amp;shareKey=77b7e46502ecf5851deafeec193416b0</span>)</span><br><span class="line"><span class="bullet">- </span>克隆虚拟机，基于1号服务器克隆出两台虚拟机，作为2、3号服务器使用。使用前面的netconfig.sh脚本进行网络配置。</span><br><span class="line"><span class="bullet">- </span>配置物理机的hosts文件，完成配置后，在游览器中分别访问这几个域名。</span><br></pre></td></tr></table></figure><pre><code>172.16.212.11 itshop.test172.16.212.11 www.itshop.test172.16.212.12 file.itshop.test172.16.212.13 upload.itshop.test</code></pre><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">3. </span>Nginx + PHP服务器搭建</span><br><span class="line"><span class="bullet">- </span>在3号服务器上安装PHP。安装完后php -v显示php版本信息。</span><br><span class="line"><span class="bullet">- </span>部署Nginx + PHP环境</span><br></pre></td></tr></table></figure><pre><code>cp php.ini-production /usr/local/php/lib/php.ini  # 复制php.ini配置你文件vi /usr/local/php/lib/php.ini  # 配置时区为PRC?# 创建服务脚本、设置开机启动cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpmchmod +x /etc/init.d/php-fpmchkconfig --add php-fpm# 复制php-fpm配置文件、启动服务cd /usr/local/php/etccp php-fpm.conf.default php-fpm.confcd php-fpm.dcp www.conf.default www.confvi www.conf更改如下:[www]user=wwwgroup=wwwlisten=/tmp/php-cgi.socklisten.owner=wwwlisten.group=www#启动php-fpmservice php-fpm start# 在Nginx配置文件中加入PHP支持，server模块。location ~ \.php$ {        try_files $uri =404;        fastcgi_pass   unix:/tmp/php-cgi.sock;        include        fastcgi.conf    }# 测试，在/data/www下创建index.php内容如下：&lt;?phpphpinfo();?&gt;# 在游览器中地址输入ip:/index.php</code></pre><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">image</span>](<span class="link">https://note.youdao.com/yws/api/personal/file/WEBcacc65278849272bd250c13788d520c3?method=download&amp;shareKey=a262787ec230fc14cb2257fc34e18f88</span>)</span><br><span class="line"><span class="bullet">- </span>克隆虚拟机，基于3号服务器克隆出4号和5号虚拟机，并用脚本配置网络。</span><br><span class="line"><span class="bullet">- </span>配合防火墙，4、5号服务器不需要被外部访问，只允许1号负载均衡服务器的IP地址进行访问。</span><br></pre></td></tr></table></figure><pre><code>// TODO  未完成</code></pre><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>配置反向代理和负载均衡</span><br><span class="line">![<span class="string">image</span>](<span class="link">https://note.youdao.com/yws/api/personal/file/WEBc1fa6f184b9413cee095af0ba3c73911?method=download&amp;shareKey=6a33442152b2f0d02333cba283fc9612</span>)</span><br><span class="line"><span class="bullet">- </span>还需在后端服务器nginx中配置如下</span><br></pre></td></tr></table></figure><pre><code>real_ip_header X-Real-IP;set_real_ip_from </code></pre><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- 访问<span class="number">172.16</span><span class="number">.212</span><span class="number">.11</span>/index.php查看其中的server_addr为后端服务器ip交替出现。</span><br><span class="line"><span class="number">4.</span> 搭建NFS文件服务器。</span><br><span class="line">- 为了使<span class="number">2</span>、<span class="number">3</span>号服务器能够同时访问<span class="number">6</span>号服务器中的文件，就需要利用NFS实现文件共享。</span><br><span class="line">- 在<span class="number">6</span>号服务器中，执行命令：yum -y install nfs-utils，之后配置NFS端口号。</span><br></pre></td></tr></table></figure><pre><code># vi /etc/sysconfig/nfs#找到如下一行，取消注释MOUNTD_PORT=892</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>开启服务</span><br></pre></td></tr></table></figure><pre><code># 开启rpcbind服务# service rpcbind start# 开启nfs服务# service nfs start# 配置NFS服务开机自动自启chkconfig nfs on# 开启与NFS相关的端口号 TODO 未成功iptables -I INPUT -p udp --dport 111 -j ACCEPTiptables -I INPUT -p udp --dport 892 -j ACCEPTiptables -I INPUT -p tcp --dport 2049 -j ACCEPTiptables save  # TODO 没用解决方法:http://blog.163.com/xavier_666/blog/static/25884000720163299503423/</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>配置共享目录</span><br></pre></td></tr></table></figure><pre><code># 创建用于共享的目录mkdir /sharechmod 777 /share# 配置/share为共享目录，语法是“路径 IP段(权限)”， 任意IP为*表示echo '/share *(rw)' &gt; /etc/exports注： *号与(rw)之间并没有空格# 使配置生效service nfs reload</code></pre><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 在<span class="number">2</span>号服务器中挂载NFS共享目录，实现远程文件的读写操作。</span><br></pre></td></tr></table></figure><pre><code># 安装NFS软件包yum -y install nfs-utils# 查看NFS服务器中的共享目录showmout -e 172.16.212.16# 将NFS服务器中的共享/share目录挂载到本地目录&quot;/data/share&quot;（也可以是其他目录）mkdir /data/sharemount 172.15.212.15:/share /data/share# 读写文件测试cd /data/shareecho Hello  &gt;test.txtcat test.txt# 使2号服务器开启自动挂载NFS目录echo '172.16.212.16:/share /data/share nfs defaults 0 0' &gt;&gt; /etc/fstab</code></pre><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>在2号服务器中配置文件缓存。通过部署文件缓存服务器降低后端文件存储服务器的压力。</span><br><span class="line">![<span class="string">image</span>](<span class="link">https://note.youdao.com/yws/api/personal/file/WEBb66f7180d6ba8085b9832efe20000900?method=download&amp;shareKey=0eb6d6d844c9ab099aaf94c748765dcd</span>)</span><br><span class="line"><span class="bullet">5. </span>配置文件上传服务器，3号服务器。</span><br><span class="line"><span class="bullet">- </span>挂载NFS共享目录</span><br><span class="line"><span class="bullet">- </span>配置Nginx对请求数据量的限制。</span><br></pre></td></tr></table></figure><pre><code>#在server块中client_max_body_size 20m;另外，在php.ini中对于上传文件的限制，增加到10M.# vi /usr/local/php/lib/php.inipost_max_size=20M  # 通过POST提交的最大限制file_uploads=On    # 是否允许文件上传upload_max_filesize=10M    # 上传文件最大限制;upload_tmp_dir=           # 上传文件临时保存目录，默认为/tmp目录# 重启服务service php-fpm reloadservcie nginx reload</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>上传文件测试 在第三个服务器上编写如下脚本页面：</span><br></pre></td></tr></table></figure><form method="post" enctype="multipart/form-data">    <input type="file" name="up">    <input type="submit"></form><?phpif(isset($_FILES['up'])&&$_FILES['up']['error'] == 0) {    $savepath='uploads/'.time().'.dat';    if(move_uploaded_file($_FILES['up']['tmp_name'], "/data/share/$savepath")) {echo "File:<a href=\"http://file.itshop.test/$savepath\">Download</a>";    }}<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>测试后，发现6号文件服务器中/share/upload/目录下存在上传的文件。</span><br><span class="line"><span class="bullet">6. </span>搭建MySQL数据库服务器。</span><br><span class="line"><span class="bullet">- </span>安装依赖包 yum -y install gcc-c++ cmake ncurses-devel</span><br><span class="line"><span class="bullet">- </span>下载免安装的mysql，解压文件到/usr/local。</span><br><span class="line"><span class="bullet">- </span>在/etc/bashrc中设置环境变量添加指向Mysql下bin目录。</span><br><span class="line"><span class="bullet">- </span>配置MySQL。</span><br></pre></td></tr></table></figure>    vi /etc/my.cnf    #找到如下配置进行更改    datadir=/data/mysql    socket=/tmp/mysql.sock    user=mysql<pre><code># 根据my.cnf中的配置，创建mysql用户useradd -s /sbin/nologin -M mysql# 运行mysql_install_db程序初始化数据库，初始化后将会在数据库中保存目录中生成的数据库文件./scripts/mysql_install_db  [ 未完成 ]#启动MySql在mysql目录的bin目录下启动mysqld#配置防火墙允许3306端口访问。iptables -I INPUT -p tcp --dport 3306 -j ACCEPT# 启动mysql后修改密码./mysqladmin -uroot -pCcRH#UK2Nztn password 123456</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>实现MySQL主从复制</span><br><span class="line"><span class="bullet">- </span>基于7号服务器克隆出8号服务器，配置网络信息。</span><br><span class="line"><span class="bullet">- </span>主数据库服务器开启bin日志</span><br></pre></td></tr></table></figure><pre><code># vi /etc/my.conflog-bin=mysqlbin-logserver-id=17</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>创建用于从数据库登录主数据库的用户</span><br></pre></td></tr></table></figure><pre><code>CREATE USER 'slave'@'172.16.212.18' IDENTIFIED BY '123456';</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>配置从服务器。</span><br></pre></td></tr></table></figure><pre><code>mysql&gt; CHANGE MASTER TO master_host='172.16.212.17', master_user='slave', \-&gt; master_password='123456', master_log_file='mysqlbin-log.000002', master_log_pos=639;mysql&gt; start slave;mysql&gt; show slave status \G# 若要停止从服务器同步，在从服务器mysql中执行slave stop# 检测 TODO 主从数据库  相关命令在主数据库中插入数据，从数据库中同样也插入数据。在从数据库中插入数据，在主数据库中并不能看到数据。成功。</code></pre><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">7. </span>搭建Memcached缓存服务器。</span><br><span class="line"><span class="bullet">- </span>安装依赖包：yum -y install gcc libevent-devel</span><br><span class="line"><span class="bullet">- </span>编译安装Memcached</span><br></pre></td></tr></table></figure><pre><code>tar -zxvf memcached-1.5.8.tar.gzcd memcached-1.5.8./configuremake &amp;&amp; make install</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>添加系统服务、配置开机自启</span><br></pre></td></tr></table></figure><pre><code>cd scriptscp memcached-init /etc/init.d/memcachedchkconfig --add memcached</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>在memcached服务脚本中还调用了start-memcached脚本，需拷贝</span><br></pre></td></tr></table></figure><pre><code>mkdir -p /usr/share/memcached/scriptscp start-memcached /usr/share/memcached/scripts/</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>为start-memcached脚本创建连接</span><br></pre></td></tr></table></figure><pre><code>ln -s /usr/local/bin/memcached /usr/bin/memcached</code></pre><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- 目前还不能通过service命令启动memcached服务，因为memcached中的脚本依赖于perl和<span class="literal">start</span>-<span class="literal">stop</span>-daemon，需单独下载。</span><br></pre></td></tr></table></figure><pre><code>tar -xvf dpkg_1.13.11.tar.gz cd dpkg-1.13.11/./configure --without-libselinux &amp;&amp; makecp utils/start-stop-daemon /usr/local/sbin/</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>启动Memcached服务。</span><br></pre></td></tr></table></figure><pre><code>vi /etc/memcached.conf 创建配置文件，内容如下：-m 512      # 分配的内存大小，单位是MB，默认为64MB-p 11211    # 配置监听的TCP端口，默认为11211-u nobody   # 配置Memcached的工作用户-c 1024     # 配置最高并发连接数，默认1024-t 16       # 配置使用的线程数，默认为4注：可以通过：/usr/local/bin/memcached -H 查看说明，根据服务器的硬件配置。service memcached startiptables -I INPUT -p tcp --dport 11211 -j ACCEPT</code></pre><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>PHP访问Memcached。</span><br></pre></td></tr></table></figure><pre><code>将PHP的Memcached扩展和libmemcached下载到3、4、5号服务器中，进行以下安装过程:# 安装依赖包yum -y install cyrus-sasl-devel# 编译安装libmemcachedtar -zxvf libmemcached-1.0.18.tar.gz cd libmemcached-1.0.18./configure &amp;&amp; make &amp;&amp; make install &amp;&amp; cd ..# php7 这种方法不行# 为PHP的Memcached扩展生成configure文件tar -zxvf memcached-2.2.0.tgzcd memcached-2.2.0/usr/local/php/bin/phpize# 编译安装PHP的Memcached扩展./configure --with-php-config=/usr/local/php/bin/php-configmake &amp;&amp; make install &amp;&amp; cd ..https://blog.csdn.net/xahuo/article/details/50372736# 在PHP配置文件php.ini中加载Memcached扩展vi /usr/local/php/lib/php.ini; memcached extensionextension=usr/local/php/lib/php/extensions/no-debug-non-zts-20151012/memcached.so# PHP_FPM重新加载配置service php-fpm reload# 在/data/www下编写测试页面test.php&lt;?php$mem=new Memcached();$mem-&gt;addServer('172.16.212.19', 11211);$mem-&gt;set('UserName', 'James');echo $mem-&gt;get('UserName');?&gt;# 使用telnet测试端口是否可以访问: telnet 172.16.212.19 11211# 9号服务器需要打开端口iptables -I INPUT -p tcp --dport 11211 -j ACCEPT# 访问成功</code></pre><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">8. </span>ThinkPHP项目部署</span><br><span class="line"><span class="bullet">- </span>创建MySQL独立数据库用户</span><br></pre></td></tr></table></figure><pre><code># 在7号服务器中启动MySql客户端，登录MySql服务器mysql -uroot -p123456# 创建数据库CREATE DATABASE itshop;# 为4、5号服务器创建无权限用户itshop，密码为123456create user 'itshop'@'172.16.212.14' identified by '123456';create user 'itshop'@'172.16.212.15' identified by '123456';# 为用户分配指定数据库的权限</code></pre><pre class="highlight"><code class=""></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>VIM 快捷键</title>
      <link href="/2018/05/04/VIM-%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
      <url>/2018/05/04/VIM-%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="map-可以将功能键映射为命令组合不同模式不同含义"><a class="markdownIt-Anchor" href="#map-可以将功能键映射为命令组合不同模式不同含义"></a> map 可以将功能键映射为命令组合，不同模式不同含义</h3><h3 id="录制宏重复工作自动化完成"><a class="markdownIt-Anchor" href="#录制宏重复工作自动化完成"></a> 录制宏，重复工作自动化完成</h3><h3 id="一-正常模式normal-mode"><a class="markdownIt-Anchor" href="#一-正常模式normal-mode"></a> 一、正常模式(Normal-mode)</h3><p>用户刚启动进入正常模式下，其他模式下按下Esc键/Control + [（更方便）进入再次正常模式。</p><ul><li>r : <strong>替换</strong>当前光标下字符。</li><li>R : <strong>一直替换</strong>光标所在的文字，直到按下Esc键/Control + [ （常用）。</li></ul><h4 id="1-移动光标"><a class="markdownIt-Anchor" href="#1-移动光标"></a> 1. 移动光标</h4><h5 id="字符"><a class="markdownIt-Anchor" href="#字符"></a> 字符</h5><ul><li>h : 左。</li><li>l : 右。 # w更常用。</li><li>j : 下。</li><li>k : 上。</li></ul><h5 id="单词"><a class="markdownIt-Anchor" href="#单词"></a> 单词</h5><ul><li>w : 移至下一个单词的词首。</li><li>e : 移至当前或下一个单词的词尾。</li><li>b : 光标向前移动一个词。</li></ul><h5 id="行间"><a class="markdownIt-Anchor" href="#行间"></a> 行间</h5><ul><li>gg : 移至第一行。</li><li>G : 移至最后一行。</li></ul><h5 id="定位"><a class="markdownIt-Anchor" href="#定位"></a> 定位</h5><ul><li>fx ：移动光标到当前行的下一个x处,x可以是任意一个字母，使用;来重复你的上一个f命令。</li><li>Fx ：类似fx，反向。</li><li>tx ：移动光标到当前行的下一个x处的左边一个位置。</li></ul><h4 id="2-删除"><a class="markdownIt-Anchor" href="#2-删除"></a> 2. 删除</h4><ul><li>x :  <strong>删除</strong>当前光标所在处的单个<strong>字符</strong>。</li><li>dd : <strong>删除</strong>当前光标所在处的行。</li><li>dw : <strong>删除</strong>当前光标所在处的单词。</li><li>D : 删除到行尾的内容。</li></ul><h4 id="3-复制"><a class="markdownIt-Anchor" href="#3-复制"></a> 3. 复制</h4><ul><li>y命令 : 用法同删除d命令。</li></ul><h4 id="4-粘贴"><a class="markdownIt-Anchor" href="#4-粘贴"></a> 4. 粘贴</h4><ul><li>p : 粘贴到所在行的下一行或者所在字符的后面。</li><li>P : 粘贴到所在行的上一行或者所在字符的前面。</li></ul><h4 id="5-撤消"><a class="markdownIt-Anchor" href="#5-撤消"></a> 5. 撤消</h4><ul><li>u : 撤消前一次操作。</li><li>Control + r : 撤消最近一次撤消操作。</li></ul><h4 id="6-翻屏"><a class="markdownIt-Anchor" href="#6-翻屏"></a> 6. 翻屏</h4><ul><li>Control + u ：向上翻半屏。</li><li>Control + d ：向下翻半屏。</li><li>Control + f ：向下翻一屏。</li><li>Control + b ：向上翻一屏。</li></ul><h4 id="7-正常模式转插入模式"><a class="markdownIt-Anchor" href="#7-正常模式转插入模式"></a> 7. 正常模式转插入模式</h4><ul><li>i : 在所在<strong>光标前</strong>，进入插入模式下。</li><li>I : 在当前光标所在行的<strong>行首</strong>，进入插入模式。</li><li>a : 在所在<strong>光标后</strong>，进入插入模式下。</li><li>A : 在当前光标所在行的<strong>行尾</strong>，进入插入模式。</li><li>o : 在当前光标所在行的下面，<strong>新建一行</strong>，进入插入模式。</li><li>O : 在当前光标所在行的上面，<strong>新建一行</strong>，进入插入模式。</li><li>c : 如同命令d删除功能，但可以直接进入插入模式下，配合Visual模式和fx命令更佳。</li><li>ci（ ：删除（）括号中的内容并直接进入插入模式下。</li><li>ci { ：删除{}括号中的内容并直接进入插入模式下。</li></ul><h4 id="8-正常模式转命令行模式"><a class="markdownIt-Anchor" href="#8-正常模式转命令行模式"></a> 8. 正常模式转命令行模式</h4><ul><li>: : 进入<strong>命令行</strong>模式下。</li></ul><h4 id="9-避免重复"><a class="markdownIt-Anchor" href="#9-避免重复"></a> 9. 避免重复</h4><ul><li>. ：重复上一个命令。如dw，之后按.再次删除一个单词。</li><li>数字 + 命令 : 重复命令。</li></ul><h4 id="10-vim写代码"><a class="markdownIt-Anchor" href="#10-vim写代码"></a> 10. vim写代码</h4><ul><li>&gt;&gt; ：缩进所有选择的代码。</li><li>&lt;&lt;  ：反缩进所选择的代码。</li><li>gd  ：到达光标所在处函数或者变量的定义处。</li><li>* ：跳转到下一个相同单词。</li></ul><h4 id="11-历史命令"><a class="markdownIt-Anchor" href="#11-历史命令"></a> 11. 历史命令</h4><ul><li>q: ：进入历史命令。</li></ul><h3 id="二-插入模式insert-mode"><a class="markdownIt-Anchor" href="#二-插入模式insert-mode"></a> 二、插入模式(Insert-mode)</h3><p>在正常模式下按下i键进入插入模式。</p><ul><li>Control + n : 向下寻找匹配的关键字，显示出代码补全框后使用。（idea中同样适用）</li><li>Control + p : 向上寻找匹配的关键字。（idea中同样适用）</li></ul><h3 id="三-命令行模式command-mode"><a class="markdownIt-Anchor" href="#三-命令行模式command-mode"></a> 三、命令行模式(Command-mode)</h3><ul><li>q : 退出。</li><li>q! : 强制退出。</li><li>w : 保存。</li><li>wq : 保存并退出。</li></ul><h3 id="四-可视模式visual-mode"><a class="markdownIt-Anchor" href="#四-可视模式visual-mode"></a> 四、可视模式(Visual-mode)</h3><ul><li>v ：按字符选择。</li><li>V ：按行选择。多行拷贝。</li></ul>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
